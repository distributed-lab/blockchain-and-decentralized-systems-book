# [О DISTRIBUTED LAB](https://github.com/distributed-lab/blockchain-and-decentralized-systems-book/blob/main/chapters/volume-3/ru/0.2-About-Distributed-Lab.md)

# 1 ПРИМЕНЕНИЕ ДЕЦЕНТРАЛИЗОВАННЫХ ПОДХОДОВ ДЛЯ ОРГАНИЗАЦИИ РАЗЛИЧНЫХ СИСТЕМ

С течением времени принципы децентрализации все больше и больше используются при проектировании информационных систем разного назначения. Децентрализованные технологии используются при построении сетевых протоколов и протоколов оверлейных сетей, в системах обмена данными и сообщениями, в поисковых и финансовых системах и т. д.

Как децентрализация влияет на архитектурные изменения в привычных для пользователя системах? Каковы сложности организации mesh-сетей и чем они лучше традиционного Интернета? Необходима ли идентификация пользователю и как распределить процесс идентификации между независимыми сторонами? Какие процессы могут быть распределенными в системе аукционов? Есть ли смысл в существовании децентрализованных бирж и какие протоколы их реализации существуют? Ответы на такие вопросы мы даем в этом разделе учебного пособия.


## 1.1 Принципы функционирования и развитие mesh networks

Mesh network (mesh-сеть) – физическая топология сети передачи данных, которая подразумевает, что каждая рабочая станция (компьютер, смартфон, телевизор и т. д.) имеет прямые соединения с другими рабочими станциями и выполняет роль независимого коммутатора, принимая участие в передаче их трафика.

> **_Отличительные свойства использования mesh network_**  
> * _Повышенный уровень отказоустойчивости_
> * _Невозможность блокировок и фильтрации_
> * _Отсутствие абонентской платы_
> * _Свободное использование (permissionless)_

Топология mesh-сети подразумевает, что узел (устройство пользователя) имеет физические соединения с несколькими другими узлами, т. е. подключен проводным или беспроводным способом без посредников. Именно за счет такой избыточности и низкой вероятности одновременного разрыва нескольких соединений повышается уровень отказоустойчивости всей сети [1].

Узел mesh-сети получает и отправляет данные через своих «соседей» вместо подключения к централизованному провайдеру (рис. 1.1). Таким образом, часть трафика узла проходит через одного из его соседей, но сосед, вместо того, чтобы требовать оплату за услугу, направляет часть своего трафика через данный узел. На практике получить услуги такой сети может кто угодно без абонентской платы, потратившись только на приобретение сетевого устройства и поддержание его работы.

![Рисунок 1.1 – Передача данных между пользователями mesh-сети](/resources/img/volume-3/1.1-Operation-principles-and-development-of-mesh-networks/F-1.1-data-transmission.png "Рисунок 1.1 – Передача данных между пользователями mesh-сети")

Поскольку вся сеть поддерживается исключительно частными и независимыми лицами, осуществить блокировку конкретных узлов или фильтрацию трафика достаточно сложно. Здесь может возникнуть вопрос: будет ли законной сеть, организованная таким образом в рамках жилого района или целого города? Разумеется, все зависит от ситуации и действующего на определенной территории законодательства, но в большинстве случаев ответ достаточно прост: до тех пор, пока участники такой сети, размещая свое оборудование, не нарушают правила частной или общественной собственности, а также предусмотренные ограничения по частоте и мощности электромагнитного излучения, претензий со стороны закона к участникам быть не должно.

В сетях специального назначения, например между военными или космическими объектами, адреса узлов назначаются централизованным образом, а чтобы присоединиться к сети, нужно пройти специальную процедуру регистрации и получить разрешение. В то же время протоколы mesh-сетей общего назначения стараются обеспечить свойство permissionlessness. Поэтому в таких сетях адреса либо назначаются автоматически, либо узел самостоятельно генерирует себе адрес. Чтобы стать равноправным узлом mesh-сети, никаких разрешений получать не нужно.


### Глобальная цель mesh-сетей

Существует несколько протоколов для организации mesh-сетей. Каждый из них направлен на обеспечение определенных свойств и функций при решении локальных задач обеспечения связи, где не справляется традиционная топология и централизованные провайдеры. 

Однако глобальная идея внедрения mesh-сетей – создание альтернативного и самодостаточного Интернета, где каждый пакет данных при передаче от узла отправителя до узла получателя криптографически защищен, в котором каждый каждому является провайдером интернет-соединения, получить IP-адрес так же просто, как сгенерировать случайное число, существует множество альтернативных маршрутов между любыми двумя узлами, а термины, такие как «отказ в обслуживании» и «сеть недоступна», пользователям даже не знакомы. Использование такого Интернета будет для пользователей гораздо более приватным и защищенным от фильтрации передаваемого контента [2].

Концептуальная сложность создания глобальной mesh-сети состоит в том, что для ее старта нужно покрыть большую часть планеты устройствами, в любой момент готовыми работать по единому протоколу. Пока критическая масса таких устройств не достигнута, сравнительная польза от них крайне мала. Это означает, что для создания альтернативной глобальной сети по принципу mesh network людям для начала нужно поверить в эту идею, включить поддержку таких сетей на своих устройствах и ждать. А когда критическая масса независимых пользователей будет достигнута и покрытие будет стабильным, такую сеть можно считать альтернативным Интернетом и можно отказаться от услуг централизованных интернет-провайдеров.

Схематическую разницу между традиционным Интернетом и альтернативным можно увидеть на рис. 1.2. В традиционном Интернете существуют провайдеры сетевого соединения, через которые проходит трафик локальных групп пользователей. Кроме этого, существуют компании, которые обеспечивают каналы связи и маршрутизацию пакетов между локальными группами и континентами. Такая централизация управления трафиком ведет к двум основным проблемам традиционного Интернета. Первая связана с возможностью блокировки конкретных пользователей или конкретного контента. Вторая – с возможным отказом в обслуживании.

![Рисунок 1.2 – Подключение пользователей в традиционном и альтернативном Интернете](/resources/img/volume-3/1.1-Operation-principles-and-development-of-mesh-networks/F-1.2-connection-of-users.png "Рисунок 1.2 – Подключение пользователей в традиционном и альтернативном Интернете")

На практике существуют такие города и даже страны, которые подключены к остальной части сети только одним физическим каналом. В истории известны случаи, когда такой канал связи прерывал нормальное функционирование на сутки или даже дольше. В результате нарушалась работа многих бизнес-процессов, а также нормальная жизнь частных лиц, и ситуация накалялась вплоть до общественных беспорядков.

Альтернативный Интернет предполагает, что все каналы связи поддерживают сами пользователи. В этом случае уровень децентрализации управления трафиком максимальный, а вероятности блокировок – минимальны.

> **_Популярные протоколы для организации mesh-сетей_**  
> * _DTN_
> * _NETSUKUKU_
> * _B.A.T.M.A.N._
> * _OSPF_
> * _CJDNS_
> * _Yggdrasil_

DTN (Delay-Tolerant Networking) – одна из самых ранних альтернатив традиционным сетям передачи данных [3]. Изначально ее задачей было обеспечение надежной доставки данных в сети с большим временем распространения сигнала, длительным ожиданием в очереди на отправку или временным разрывом связи между узлами. Развитие DTN началось в 1970-х годах, когда начали появляться портативные компьютеры, и исследователи задались вопросом обеспечения надежности сетей, у участников которых нет постоянного подключения.

Узлы такой сети должны были сохранять полученные пакеты данных до тех пор, пока они не будут переданы следующему узлу. По сравнению с традиционными сетями узлы такой сети предполагают гораздо более длительное хранение пакетов и могут их записывать на диск для ожидания в очереди на отправку. Эта технология – наиболее перспективная для применения в космической связи. Поэтому под задержками в DTN понимаются не только задержки, порождаемые транзитными узлами или ограничениями пропускной способности канала связи, а и дополнительные задержки при передаче сигнала, не зависящие от объема передаваемых данных (рис. 1.3). Такие задержки могут зависеть от скорости распространения сигнала в среде передачи и пройденного расстояния, а также качества канала связи (если канал плохой, то будут происходить потери данных, что потребует дополнительного времени на их повторную передачу).

![Рисунок 1.3 – Пример сохранения данных узлами DTN](/resources/img/volume-3/1.1-Operation-principles-and-development-of-mesh-networks/F-1.3-data-saving-by-DTN-nodes.png "Рисунок 1.3 – Пример сохранения данных узлами DTN")

В DTN-сетях пакеты, уже прошедшие часть своего пути, сохраняются не только в случае больших задержек, а и в случае разрывов каналов передачи данных (за счет хранения их промежуточными узлами). Такой разрыв может произойти из-за ограничений дальности беспроводной связи, разреженности мобильных узлов, нехватки энергетических ресурсов или помех. А при восстановлении канала между узлами сохранившиеся пакеты просто продолжают свой путь вместо повторной отправки.

Протокол CJDNS – более молодой проект, его первые реализации появились в 2012 году [4]. CJDNS поддерживает открытое сообщество, и он прежде всего служит потребностям пользователей. По сравнению с другими протоколами он реализует шифрование пакетов данных между отправителем и получателем, а также шифрование данных при передаче между всеми транзитными узлами. Кроме того, есть возможность объединения нескольких частных mesh-сетей в одну большую, а также соединения узлов через традиционный Интернет.

Протокол CJDNS предполагает, что каждый узел сам себе генерирует криптографические ключи для асимметричного шифрования и связанный с открытым ключом сетевой адрес из диапазона частных адресов IPv6. Для физического соединения с «соседями» может использоваться Wi-Fi (в режиме точки доступа и клиента одновременно) или проводной Ethernet. Количество узлов в такой сети может достигать десятков миллиардов, поэтому таблица маршрутизации организована по принципам DHT (distributed hash table). Таким образом, узел сети хранит только часть таблицы и может эффективно строить маршрут для любого пакета, обращаясь к соседним узлам.

Интересным является и тот факт, что в 2017 году сообщество CJDNS раскололось, и часть разработчиков начала работу над похожим проектом – Yggdrasil [6]. Цели проекта и принципы их достижения совпадают, но разработчики Yggdrasil предлагают более децентрализованный способ маршрутизации пакетов, который позволяет полностью избежать централизованных узлов-справочников.

Протокол B.A.T.M.A.N. (Better Approach To Mobile Adhoc Networking), в отличие от большинства других, в качестве идентификаторов узлов использует MAC-адреса их сетевых интерфейсов. В сети, работающей по этому протоколу, каждый узел хранит две таблицы маршрутизации: локальную и глобальную. В локальной таблице хранится информация об узлах, с которыми есть непосредственное физическое соединение, а в глобальной таблице – наиболее актуальная информация, полученная из локальных таблиц соседей. Во время работы каждый узел регулярно отправляет широковещательные сообщения с данными о своем адресе и своей локальной таблицей маршрутизации. Отметим, что протокол B.A.T.M.A.N. поддерживается открытым сообществом, на момент 2019 года активно совершенствуется и имеет интеграцию в ядро Linux.

Разработка протокола Netsukuku была остановлена, однако он тоже имеет интересные особенности. Например, все узлы сети, работающие по этому протоколу, рассматриваются иерархически. Каждые 256 узлов образуют так называемый групповой узел (gnode), а 256 групповых узлов, в свою очередь, составляют группу более высокого порядка (ggnode) и так далее. Протокол Netsukuku логически рассматривает любой групповой узел как физический, поэтому маршрутизация может работать одинаково на всех уровнях иерархии. Преимущество такого подхода состоит в том, что при каждом поиске маршрута необходимо оперировать максимум 256 узлами, что значительно облегчает процесс. Для обмена данными о состоянии сети узлы используют TP-пакет (trace path package), где не указан получатель, однако есть данные обо всех посредниках, через которых он прошел вплоть до отправителя. Согласно протоколу один из узлов выступает инициатором и отправляет такой пакет всем своим соседям; соседи добавляют к полученному пакету данные о себе и передают дополненный пакет дальше, но никто не передает один и тот же пакет дважды. Получается, что каждый узел, принявший TP-пакет, получает полный маршрут до узла отправителя, а также до каждого из узлов-посредников.

Протокол OSPF (open shortest path first) также использует динамическую маршрутизацию, но основанную на технологии отслеживания состояния канала (link-state technology). Согласно этой технологии каждый маршрутизатор стремится знать не только лучшие маршруты к каждому узлу, но и иметь полную карту сети со всеми существующими связями между другими маршрутизаторами. А для нахождения кратчайшего пути протокол OSPF использует алгоритм Дейкстры. В таблице 1.1 приведено сравнение упомянутых протоколов организации mesh-сетей [5].

![Таблица 1.1 – Сравнительная характеристика существующих протоколов организации mesh-сетей](/resources/img/volume-3/1.1-Operation-principles-and-development-of-mesh-networks/T-1.1-en-characteristics-of-existing-protocols.png "Таблица 1.1 – Сравнительная характеристика существующих протоколов организации mesh-сетей")


### Применение mesh-сетей на практике

Наиболее распространенный и востребованный вариант mesh-сетей использует беспроводные технологии. В этом случае рабочие станции могут менять местоположение относительно остальных и создавать новые физические соединения на лету. В то же время проводные соединения не позволяют также легко подключить одну рабочую станцию к нескольким другим и переподключить при необходимости.

Изначально потребность в построении mesh-сетей возникла в военном деле, где в полевых условиях часто необходима автономная связь. Поэтому самоорганизующиеся сети стали хорошим решением для создания зон большой площади со сплошным и надежным покрытием. Такая сеть легко масштабируется при добавлении новых узлов и отказоустойчива при потере отдельных элементов сети.

Благодаря многочисленным положительным свойствам mesh-сети со временем получили распространение и в других сферах.

> **_Сферы применения mesh-сетей_**  
> * _Военное дело (соединение между компьютерами в условиях полевых операций)_
> * _Спутниковая связь (66 спутников созвездия Иридиум функционируют как единая mesh-сеть)_ [7]
> * _Связь в больших корпоративных средах_
> * _Связь на территориях с неразвитой инфраструктурой_

В мире до сих пор есть такие города и районы, куда не добрались централизованные провайдеры сетевого подключения и где местные жители решают обеспечить себя сетевым соединением, объединившись в mesh-сеть. Хороший пример – проект Guifi, который зародился в начале нулевых, когда местные жители устали ждать появления в регионе нормального интернет-провайдера. В настоящее время это одна из крупнейших mesh-сетей в мире: она состоит из более чем 35 тысяч активных узлов. Сеть развивается на общественных началах, а подключение к Guifi доступно совершенно бесплатно [8].

В сети Guifi есть так называемые «острова» – группы узлов, расположенных близко друг к другу и имеющих высокую степень связности (рис. 1.4). Каждый «остров» – это сеть, объединяющая пользователей района, муниципалитета или города. Для подключения пользователей обычно используются Wi-Fi-маршрутизаторы со специальной прошивкой. Связь между островами может обеспечиваться в том числе посредством традиционного Интернета (VPN или прокси-серверы). Кроме того, узлы, подключенные к традиционному Интернету, предоставляют и другим пользователям Guifi к нему доступ.

![Рисунок 1.4 – Карта mesh-сети Guifi в городах Испании](/resources/img/volume-3/1.1-Operation-principles-and-development-of-mesh-networks/F-1.4-map-of-mesh-network.png "Рисунок 1.4 – Карта mesh-сети Guifi в городах Испании")

Пропускная способность у каждого конкретного узла сети в каждом случае разная: у некоторых она не превышает и 1 Мбит/с, но во многих районах (особенно в горах) это по-прежнему наилучший способ подключения к Интернету.


### Особенности маршрутизации пакетов в сети

Все множество алгоритмов маршрутизации можно разделить на два класса: реактивные (reactive) и проактивные (proactive). Реактивные алгоритмы маршрутизации прокладывают маршрут для пакета данных от узла-­отправителя к узлу-­получателю только в момент самой необходимости, что создает определенную задержку при передаче первого пакета. Основное преимущество этого класса алгоритмов – отсутствие фоновой нагрузки на сеть.

При проактивном подходе поддержка таблиц актуальных маршрутов осуществляется за счет постоянного фонового обмена между узлами данными об изменениях в топологии сети, а также периодической рассылки специальных служебных пакетов. Поскольку проактивный алгоритм всегда имеет готовый маршрут к любому потенциально достигаемому узлу, то дополнительные задержки при отправке пакетов данных исключены. Но достигается это преимущество за счет фонового трафика, что приводит к снижению итоговой производительности сети по сравнению с использованием реактивных алгоритмов.

Эффективность работы и проактивных, и реактивных алгоритмов резко снижается при увеличении частоты изменений в топологии сети. Снижение эффективности работы реактивных алгоритмов объясняется тем, что кэшированные маршруты транспортировки пакетов быстро устаревают из-­за разрушения составляющих их связей. В предельном случае применение реактивного алгоритма становится невозможным из-­за того, что маршруты доставки пакетов будут устаревать за время их построения.

Использование проактивных алгоритмов в сети с частыми изменениями топологии приведет к резкому повышению объема служебного трафика для поддержания актуальности таблиц маршрутизации, что в предельном случае приводит к ситуации, когда вся пропускная способность сети используется только для передачи служебных данных. Поэтому для организации процесса маршрутизации пакетов данных в сети с часто меняющейся топологией ни проактивные, ни реактивные алгоритмы в чистом виде применяться не могут. Они пытаются построить полный путь от узла-­отправителя к узлу­-получателю, но в большой сети с постоянными изменениями длинные маршруты имеют слишком короткое время жизни. Это заставляет базироваться на локальных свойствах сети при построении эффективных алгоритмов маршрутизации. Локальный подход дает два преимущества: экономию ресурсов при реагировании на изменение топологии сети и простоту получения актуального состояния соседних узлов по сравнению с получением состояния остальных узлов сети.

Другой важный принцип построения эффективного алгоритма маршрутизации для сетей с часто меняющейся топологией – минимизация реакции на изменение топологии. Это достигается за счет того, что служебные сообщения отправляются лишь малому количеству узлов, расположенных в непосредственной близости от точки, в которой произошло изменение топологии. При этом не требуется изменение всего характера маршрутизации в сети. Таким образом, у каждого передаваемого пакета данных есть полный маршрут, но полностью его соблюдать не обязательно. Поэтому при возникновении разрывов связи или отключении узла-посредника проблему решает локальная группа из ближайших узлов.


### Недостатки mesh-сетей

> * _Начальный запуск mesh-сети сравнительно сложный_
> * _Сеть эффективно работает только при большом количестве узлов_
> * _Непредсказуемая пропускная способность сети и задержки доставки пакетов_
> * _Проблемы построения оптимальных маршрутов_
> * _Сеть малоэффективна для получения доступа к централизованным сервисам, расположенным в глобальной сети_

Mesh-сеть работает эффективно только при достаточной связности узлов. Каждый должен иметь физическое соединение с несколькими другими узлами, и между «островами» сети должно быть достаточное количество соединений. Поэтому для начального запуска сети необходимо набрать критическую массу готовых устройств.

В динамических mesh-сетях (где узлы непредсказуемо перемещаются в пространстве и отключаются) невозможно прогнозировать пропускную способность и время передачи пакета между двумя узлами сети. Это значит, что при скачивании или выгрузке файла пользователь не может получить оценку оставшегося времени, а во время аудиозвонка или потоковой передаче видео могут возникать паузы, даже если используются адаптивные протоколы передачи медиапотока, поскольку они не могут выбрать оптимальные параметры для соединения, характеристики которого невозможно предсказать.

Проблема маршрутизации также остается актуальной. Существует несколько подходов к построению маршрутов в динамических сетях, но у каждого есть свои недостатки: высокие требования к объему памяти, длительность работы, зависимость от единого узла-справочника, выбор оптимального маршрута только по одному критерию и т. д. Поскольку идеального решения быть не может, исследователи продолжают искать оптимальный баланс между имеющимися преимуществами и недостатками.

Стоит также понимать, что mesh-сеть наиболее эффективна для независимой связи частных узлов между собой. Например, для организации корпоративной IP-телефонии mesh-сеть хорошо подойдет, а если каждый член некоторой группы пользователей будет обращаться только к «facebook.com», смысла в таком объединении будет мало.


### \*\*\*Распространенные мифы\*\*\*

_Mesh-сеть не имеет доступа в Интернет._

Иногда это так, потому что некоторые протоколы для организации mesh-сетей не поддерживают возможность трансляции пакетов в глобальную сеть и обратно. Однако это не значит, что у таких mesh-сетей не может быть доступа к Интернету. Для подключения к глобальной сети используются специальные прокси- или VPN-сервера, которые mesh-сети поддерживают и которые позволяют использовать Интернет внутри mesh-сетей. 


### \*\*\*Часто задаваемые вопросы\*\*\*

_– Как объединить две mesh-сети?_

Здесь может быть несколько принципиально разных ситуаций. Если сети используют один протокол, который изначально поддерживает объединение сетей, тогда достаточно наличия одного общего узла. Если сети используют один протокол, но он не поддерживает объединение сетей, тогда необходима ручная настройка хотя бы одного общего маршрутизатора и транслятора сетевых адресов. Если сети используют разные протоколы, то объединение сетей может оказаться вообще невозможным ввиду использования разных форматов адресов, форматов пакетов данных, наличия сквозного (end-to-end) шифрования и других особенностей взаимодействия.

_– Могут ли mesh-сети и соответствующие технологии оказаться под запретом регулятора?_

Запрещать использовать саму технологию очень неправильно, т. к. она может использоваться для разных целей. Одни могут использовать mesh-сети для передачи запрещенного контента или сокрытия следов преступной деятельности, а другие – для достижения совершенно благородных целей. Например, интернет-провайдерам и операторам мобильной связи удобно использовать mesh-сети для упрощения настройки своего оборудования за счет самоорганизации. Сетевым администраторам удобно использовать mesh-сети для создания беспроводной сети с большой зоной покрытия (торговые центры, офисные здания и т. п.). В сфере интернета вещей использование mesh-сетей также очень актуально для обнаружения ближайших устройств и взаимодействия с ними.

## 1.2 Децентрализованные системы цифровой идентификации

Для каждого из нас можно составить набор из определенных атрибутов (данных), который однозначно выделяет нашу личность среди остальных, причем это могут быть как физические характеристики (отпечатки пальцев, рисунок сетчатки глаза), так и их цифровые аналоги (адрес электронной почты, открытый ключ цифровой подписи) (рис. 1.5). Все это – идентификационные данные, или personally identifiable information (PII) [9].

![Рисунок 1.5 – Идентификационные данные пользователя](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.5-user-identity-data.png "Рисунок 1.5 – Идентификационные данные пользователя")

Когда пользователь хочет впервые воспользоваться услугой сервиса (например, открыть счет в банке, завести электронную почту, получить биометрический паспорт и т. д.), причем не важно, в цифровом виде или нет, система, скорее всего, попросит его предоставить набор идентификационных данных и на основании них создаст в своей локальной базе учетную запись, в которую запишет соответствие между идентификационными данными пользователя и _локальным идентификатором_. Так у человека появится _digital identity_ [10].

Процесс сбора уникальных данных называется _идентификацией_. Процедура идентификации в большинстве случаев необходима, чтобы сервис понимал, с кем он взаимодействует, так как зачастую к аккаунту, который закреплен за конкретным пользователем, привязан набор разрешений или прав, доступных только конкретному пользователю [11].

> _Замечание. Здесь и далее сервисы, предоставляющие услуги идентификации, мы будем называть провайдерами идентификации (identity provider)._

После прохождения идентификации пользователь получает идентификатор в границах системы (рис. 1.6). При дальнейшем взаимодействии с текущей системой пользователю не нужно будет повторно предоставлять свои идентификационные данные, а «узнавать» его будут по выданному ранее локальному идентификатору, в роли которого может выступать номер счета в некотором банке, адрес электронной почты, который был использован для регистрации в системе, или биометрический паспорт. Процедура проверки, что пользователь является тем, за кого себя выдает, называется _аутентификацией_ [12].

![Рисунок 1.6 – Прохождение пользователем процедуры идентификации у различных провайдеров](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.6-user-identification-procedure.png "Рисунок 1.6 – Прохождение пользователем процедуры идентификации у различных провайдеров")

На этом этапе важно выделить одно из ограничений такого подхода: базы данных провайдеров идентификации никак не связаны и не синхронизированы между собой. Это приводит к тому, что конкретный идентификатор может использоваться только в системе, в которой он был выдан. Следовательно, мы имеем ситуацию, когда одной физической личности (physical identity) соответствует множество digital identities (рис. 1.7).

![Рисунок 1.7 – Идентификаторы пользователя в различных учетных системах](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.7-user-identifiers.png "Рисунок 1.7 – Идентификаторы пользователя в различных учетных системах")

Хотя такая парадигма сейчас применяется повсеместно, она влечет определенные неудобства как для пользователей, так и для провайдеров.

> **_Недостатки существующих систем идентификации_**  
> * _Нерациональное использование ресурсов_
> * _Несоблюдение политики обработки персональных данных_
> * _Риск хищения персональных данных пользователя_
> * _Несоблюдение парольной политики_

Первый недостаток заключается в том, что пользователь вынужден тратить время для регистрации на каждом новом сервисе, заполнять идентичные (либо практически идентичные) регистрационные формы, придумывать новые логины и пароли, проходить капчу, подтверждать регистрацию при помощи e-mail и т. д. Согласитесь, такой процесс приносит массу неудобств, особенно если необходимо воспользоваться сервисом лишь однажды (например, форматирование картинки) или окажется, что это не совсем тот сервис, который нужен пользователю.

Как мы упоминали ранее, идентификационные данные включают в себя персональные данные пользователя, которые должны собираться, обрабатываться и храниться с соблюдением требований GDPR [13] (или других схожих нормативных документов). Абсолютно все подобные регуляции включают один из главных принципов: необходимость контроля владельцем собственных персональных данных. Однако на практике ситуация абсолютна не такая: большинство пользователей даже не представляют, что происходит с их персональными данными после того, как они подписали бумагу (или поставили галочку) о согласии на их обработку (рис. 1.8).

![Рисунок 1.8 – Пример соглашения на обработку персональных данных](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.8-personal-data-processing-agreement.png "Рисунок 1.8 – Пример соглашения на обработку персональных данных")

Чаще всего при прохождении процедуры идентификации персональные данные передаются в открытом виде. В таком же виде они и обрабатываются провайдером идентификации. Это влечет повышение вероятности перехвата персональных данных злоумышленником.

Кроме того, у пользователя собирается большое количество идентификаторов и соответствующих им паролей, необходимых для аутентификации в различных системах. Представьте, что вы стоите перед закрытой дверью с большой связкой ключей и не можете вспомнить, какой именно ключ подходит к этой двери (рис. 1.9). В таких условиях пользователи стараются упростить себе жизнь и используют один пароль для доступа к различным сервисам. В этом случае компрометация пароля на одной из сторон приведет к получению доступа во многих независимых системах.

Следует учесть и тот факт, что парольная политика у каждого провайдера своя, и помимо того, что пользователю необходимо следить за сохранностью своих паролей, ему нужно еще и вовремя их обновлять [14].

![Рисунок 1.9 – Традиционный процесс получения доступа к системе](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.9-traditional-access-gaining.png "Рисунок 1.9 – Традиционный процесс получения доступа к системе")

Логичным решением может быть возможность использования ранее собранных идентификационных данных повторно. Например, пользователь, у которого уже есть аккаунт Google, хочет воспользоваться сервисом draw.io и создать диаграмму. Вместо того, чтобы заново заполнять регистрационную форму и проходить процедуру идентификации, он может попросить Google предоставить сервису необходимую информацию. Ниже мы рассмотрим, каким образом возможно организовать такое взаимодействие.


### Устройство и принципы функционирования протокола OAuth

Протокол OAuth [15] предоставляет решение, которое позволяет сторонним приложениям получить ограниченный контролируемый владельцем доступ к его ресурсам (например, к персональным данным).

> **_Роли в протоколе OAuth_** 
> * _Владелец ресурса_
> * _Хранитель ресурса_
> * _Клиент_
> * _Сервер авторизации_

_Владелец ресурса_ – фактически сам пользователь. Он может предоставить разрешение другим сторонам (_клиентам_) на получение доступа к ресурсу.

_Клиент_ – приложение/сервис, которое может формировать запросы от имени владельца ресурса для получения данных, которые принадлежат владельцу ресурса.

_Хранитель ресурса (resource server)_ – сервер, на котором хранится защищенный ресурс (например, сервер Google, который хранит данные пользователя).

_Сервер авторизации (authorization server)_ – сервер, который выпускает токены доступа для клиента после его успешной аутентификации (подтверждения прав на доступ к ресурсу).

Основная идея протокола OAuth заключается в том, чтобы вместо учетных данных пользователя (его логина и пароля) для доступа к защищенному ресурсу использовать токен специального назначения – цифровую строку, которая содержит атрибуты доступа. По таким атрибутам легко определить, к какой именно информации был предоставлен доступ, на какое время и кому.

Токены доступа выдаются сервером авторизации с одобрения владельца ресурса. Сервис использует токен для получения доступа к защищенным ресурсам, размещенным на стороне хранителя ресурсов (рис. 1.10).

> _Замечание. Взаимодействие между сервером авторизации и сервером ресурсов выходит за рамки этого протокола. Сервер авторизации может быть тем же сервером, что и сервер ресурсов, или отдельным объектом. Один сервер авторизации может выдавать токены доступа, которые принимаются несколькими серверами ресурсов._

![Рисунок 1.10 – Функционирование протокола OAuth](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.10-OAuth-protocol.png "Рисунок 1.10 – Функционирование протокола OAuth")

Согласно протоколу OAuth 2.0 предполагается следующий порядок взаимодействия:

1. Клиент формирует авторизационный запрос и направляет его владельцу ресурса. Запрос на авторизацию может быть отправлен владельцу ресурса непосредственно (как показано на рис. 1.10) или косвенно, через сервер авторизации.
2. Владелец ресурса передает клиенту Authorization Grant, который содержит подтверждение того, что клиент на самом деле имеет разрешение на получение доступа к ресурсу.
3. Клиент запрашивает токен доступа на сервере авторизации. Для подтверждения того, что клиент действует от имени владельца ресурса, в запрос включается Authorization Grant, полученный на предыдущем шаге. Здесь Authorization Grant выступает подтверждением успешной аутентификации пользователя на стороне сервера авторизации. Обратите внимание, что сервер авторизации на этом шаге не знает, какому приложению (клиенту) они выдаются, но точно знает, что клиент получил необходимое разрешение от владельца ресурса.
4. Сервер авторизации проверяет разрешения клиента (т.е. понимает, что именно владелец ресурса предоставляет разрешение этому клиенту) и Authorization Grant. Если Authorization Grant действителен, выдает токен доступа.
5. Клиент запрашивает защищенный ресурс у хранителя ресурса после аутентификации и использует токен доступа. 
6. Хранитель ресурса проверяет токен доступа и, если токен доступа действителен, обрабатывает запрос. На этом этапе хранитель ресурса точно знает, какому приложению выдается токен доступа, и точно уверен, что это происходит с согласия владельца данных.

Таким образом, пользователю достаточно один раз ввести набор персональных данных на одном сервисе, после чего станет возможной выдача токенов доступа к разным частям такого набора различным клиентам. Например, точно по такому же принципу, как описано выше, пользователь может разрешить приложению на своем смартфоне сохранять сделанные фото на Google Drive автоматически.


### Протоколы OpenID и OpenID Connect

OpenID предлагает концепцию создания единой учетной системы для различных интернет-ресурсов, которая избавила бы пользователей от необходимости постоянно заполнять регистрационные формы (проходить процедуру идентификации) и, соответственно, накапливать новые пары логин–пароль.

Идея заключается в том, чтобы хранить единую учетную запись на одном сервисе (у одного из OpenID-провайдеров) и пользоваться ею для регистрации на других сервисах, которые поддерживают протокол OpenID.

> _Замечание. К OpenID-провайдерам относятся Google, Microsoft, Symantec, Verizon, Oracle, VMware._

Протокол предполагает участие трех сторон:

* Пользователя, который хочет использовать свой OpenID идентификатор
* Интернет-сервиса, доступ к которому хочет получить пользователь
* OpenID-провайдера, который ранее провел процедуру идентификации пользователя

Протоколы OpenID первого и второго поколения [16] были нацелены исключительно на аутентификацию пользователя на стороне одного из OpenID-провайдеров, результат которой передавался напрямую проверяющей стороне – сервису, с которым хотел взаимодействовать пользователь (рис. 1.11).

![Рисунок 1.11 – Функционирование протокола OpenID](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.11-OpenID-protocol.png "Рисунок 1.11 – Функционирование протокола OpenID")

Процедура установления канала связи между интернет-сервисом и OpenID-провайдером (на шаге 3) осуществляется по внутреннему алгоритму check_Id, который представляет собой протокол двухпроходной аутентификации и позволяет взаимодействующим сторонам убедиться в подлинности друг друга. Опционально между интернет-сервисом и провайдером возможно установление общего секрета по протоколу Диффи–Хеллмана (в этом случае, при помощи MAC-кода, интернет-сервис может надежно аутентифицировать провайдера без дополнительных запросов по получению информации о его сертификате). Функционирование протокола Диффи–Хеллмана было рассмотрено во 2-й части данного учебного пособия.

В результате работы протокола интернет-сервис удостоверяется в том, что пользователь – тот, за кого себя выдает, потому что это подтвердил один из доверенных провайдеров идентификации. В то же время никакая другая информация о пользователе не раскрывается. Отметим, что ни OpenID 1.0, ни OpenID 2.0 не были совместимы с протоколом OAuth.

Протокол третьего поколения, получивший название OpenID Connect [17], представляет собой надстройку над протоколом авторизации OAuth 2.0. OpenID Connect позволяет интернет-сервисам проверить личность пользователя на основе аутентификации, выполненной авторизационным сервером (рис. 1.12).

В рамках протокола OpenID Connect будем рассматривать следующие роли протокола:

* Конечного пользователя – объект, который получает доступ к ресурсу клиента
* Проверяющую сторону (клиент, RP) – сервис, который согласно протоколу OAuth 2.0 требует аутентификации конечного пользователя и доступа к части информации о нем от OpenID-провайдера
* OpenID-провайдера (OP) – сервер авторизации, способный аутентифицировать конечного пользователя и предоставить проверяющей стороне информацию о событии аутентификации и о конечном пользователе

![Рисунок 1.12 – Функционирование протокола OpenID Connect](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.12-OpenID-Connect-protocol.png "Рисунок 1.12 – Функционирование протокола OpenID Connect")

В обобщенном виде взаимодействие в рамках протокола OpenID Connect происходит следующим образом:

1. Сервис направляет запрос аутентификации к OpenID-провайдеру.
2. Пользователь проходит процедуру аутентификации на стороне OpenID-провайдера, после которой пользователь сообщает, какому именно сервису необходимо предоставить доступ к персональной информации.
3. В результате выдаются два токена (ID Token и Access Token), которые включаются в AuthResponse. ID Token несет в себе информацию об Authentication event – набор информации о том, какой пользователь инициировал выдачу токенов и для какой клиентской стороны на сервере. Access Token представляет собой точно такой же токен, как было описано выше в протоколе OAuth.
4. Используя полученный Access Token, проверяющая сторона направляет запрос на получение информации о пользователе, которая хранится на стороне OpenID-провайдера.
5. OpenID-провайдер проверяет токен доступа, и, если он действителен, обрабатывает запрос.


### Ограничения описанных протоколов

Предложенные протоколы, конечно, упрощают взаимодействие пользователей и провайдеров идентификации, однако, остается несколько ключевых проблемных вопросов.

> * _Отсутствие прямого контроля пользователем своих персональных данных_
> * _Проблема доверия централизованным провайдерам_
> * _Уязвимости, связанные с аутентификацией по паре логин–пароль_
> * _Риски, возникающие при использовании сессий_
> * _Отсутствие синхронизации идентификационных событий_

Оба описанных выше подхода предполагают хранение критической информации (в т. ч. PII) пользователя на одном ресурсе. Соответственно, обеспечение ее сохранности полностью зависит от политики безопасности данного ресурса, и сам ресурс этими данными фактически владеет. В итоге, пользователь все еще не может полностью контролировать свои персональные данные.

Второе ограничение связано с необходимостью доверия централизованным провайдерам идентификации. Сервис получает информацию от конкретного провайдера и считает ее верной. По сути, отсутствует объективность в процессе решения вопроса о доверии отдельной identity.

Метод аутентификации по паре логин–пароль недостаточно надежный. Компрометация пароля (а пользователи не всегда используют действительно сильные пароли) приводит к компрометации всех персональных данных пользователя. Более того, если вспомнить о том, насколько пользователи не любят придумывать новые пароли, то компрометация одного пароля открывает сразу много «дверей».

Уязвимости протокола OAuth также связаны с сессионной природой протокола. Если злоумышленнику удастся перехватить Authorization Grant во время такой сессии, то у него появится возможность реализации атаки человека посередине (man-in-the-middle).

Пользователь может иметь несколько OpenID-идентификаторов, которые не будут связаны друг с другом. Таким образом, вопрос существования множества digital identity до конца не решен.


### Принципы построения глобальной системы идентификации

Ниже рассмотрим, каким образом возможно построить глобальную децентрализованную систему идентификации. Основные принципы такой системы:

> * _Прямой контроль пользователем собственных идентификационных данных_
> * _Identity пользователя содержит digital digest персональных данных с целью обеспечения проверки их целостности_
> * _Связь идентификационных данных с ключами, которые принадлежат пользователю_
> * _Распределенное хранение идентификационных данных провайдерами, которые эти данные подтвердили_
> * _Синхронизация идентификационных событий между независимыми провайдерами_

Основная роль глобальной цифровой системы идентификации – связь глобального идентификатора пользователя с его открытым ключом и персональными данными, которые этому пользователю принадлежат, посредством проверки этой связи несколькими identity providers (рис. 1.13).

![Рисунок 1.13 – Концепция глобальной системы цифровой идентификации](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.13-global-digital-identity-system.png "Рисунок 1.13 – Концепция глобальной системы цифровой идентификации")

Наиболее безопасный подход к аутентификации (и авторизации) состоит в том, что для каждой учетной системы, с которой взаимодействует пользователь, право проведения разрешенных для идентификатора операций (и доступа к разрешенным данным) проверяется при помощи владения открытым ключом, к которому привязан идентификатор. Владение открытым ключом проверяется посредством вычисления (и дальнейшей проверки) цифровой подписи.

Учетная система, с которой в данный момент хочет взаимодействовать пользователь, получив запрос от него, может обратиться к глобальной цифровой системе идентификации и получить актуальный открытый ключ, соответствующий конкретному идентификатору, после чего проверить подпись запроса (рис. 1.14).

![Рисунок 1.14 – Проверка связи идентификационных данных с открытым ключом при получении запроса](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.14-verification-of-link-of-identification-data.png "Рисунок 1.14 – Проверка связи идентификационных данных с открытым ключом при получении запроса")

Хранение критической (sensitive) информации в открытом виде требует дорогостоящих методов защиты, однако, возможно хранить не саму информацию, а ее цифровой отпечаток (хэш-значение), по которому будет легко определить, что пользователь действительно владеет доступом к своим персональным данным.

Пользователь должен иметь возможность хранить различные наборы идентификационных данных в разных учетных системах и при необходимости предоставлять запрашиваемую третьей стороной информацию, не создавая нового набора.

Давайте представим себе пользователя, у которого есть аккаунты в нескольких учетных системах, которые хранят необходимые им наборы персональных данных (рис. 1.15).

![Рисунок 1.15 – Данные, которые хранятся различными провайдерами идентификаци](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.15-data-stored-by-different-identity-providers.png "Рисунок 1.15 – Данные, которые хранятся различными провайдерами идентификаци")

К примеру, пользователь хочет оформить электронный страховой полис на новый автомобиль. Для этого страховая компания требует предоставить следующий набор данных: адрес электронной почты, на который необходимо выслать полис, паспортные данные, подтверждение наличия достаточного количества средств для внесения ежемесячных платежей, данные водительского удостоверения.

На сегодня даже с использованием вышеописанных протоколов не существует удобного для пользователя способа дистанционно предоставить страховой компании необходимый набор данных. Даже если страховая компания принимает OpenID-идентификаторы, пользователю после прохождения процедуры аутентификации необходимо будет «вручную» предоставлять требуемый пакет документов. Протокол OAuth также не дает заметного выигрыша, т. к. для его применения пользователю потребуется авторизовать все свои клиентские приложения (если они есть вообще) в учетной системе страховой компании.

В концепции глобальной системы идентификации пользователю, по сути, необходимо будет сформировать и выдать страховой компании набор разрешений с указанием, в каких из существующих учетных систем хранятся части требуемого набора данных (рис. 1.16). Такой набор разрешений может подписываться личным ключом пользователя, так что каждый из провайдеров идентификации сможет надежно проверить, что запрос выполняется с разрешения владельца данных (пользователя).

![Рисунок 1.16 – Получение информации от различных провайдеров идентификации](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.16-retrieving-information.png "Рисунок 1.16 – Получение информации от различных провайдеров идентификации")

При этом можно увидеть, что запросы от страховой компании поступают только в те учетные системы, которые указал пользователь. Таким образом, ему не пришлось самому формировать и предоставлять необходимый набор информации, как и не пришлось заводить дополнительный аккаунт в новой учетной системе.


### Расширение возможностей глобальной системы идентификации с помощью технологии blockchain

Организация сети между провайдерами идентификации с использованием технологии blockchain позволит создать распределенную базу данных с метками времени для каждой проведенной транзакции. Транзакцией в такой системе может быть событие прохождения пользователем процедуры идентификации у одного из провайдеров. Это делает транзакции легко отслеживаемыми, необратимыми, а также предотвращает мошенничество, злоупотребления и любые другие виды манипуляций.

После проведения процедуры идентификации пользователя провайдер добавляет соответствующую запись в цепочку блоков. Если пользователю необходимо получить доступ к другому сервису, пользователь обращается к нему, используя собственный идентификатор.

Система, в свою очередь, запрашивает данные о том, кто из других провайдеров уже идентифицировал пользователя. Владелец каждой системы самостоятельно определяет, насколько доверять событиям идентификации (а соответственно, и результатам этих событий), выпущенным другой системой. Если уровень доверия максимальный, то система предоставляет пользователю услугу на основании его идентификатора. Если доверие к системе (либо набору систем) ниже, то клиент может запросить данные пользователя и убедиться, что они соответствуют тем, которые хранятся в распределенном реестре.

Стоит отметить, что доступ к персональным данным осуществляется только после одобрения пользователя. Если предоставленных данных достаточно, система дает пользователю доступ; если нет (например, необходимы дополнительные данные), то система отдельно проводит идентификацию пользователя с соответствующей записью в реестре.

Давайте рассмотрим, как можно в такой системе организовать процедуру идентификации (также известную как «Know Your Customer», KYC) (рис. 1.17).

![Рисунок 1.17 – Прохождение пользователем идентификации с добавлением соответствующего события в систему](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.17-passing-identification-procedure.png "Рисунок 1.17 – Прохождение пользователем идентификации с добавлением соответствующего события в систему")

1. Алиса отправляет свой собственный открытый ключ и данные, необходимые для прохождения процедуры KYC, банку, который является провайдером идентификации.
2. Банк помещает полученные персональные данные пользователя в надежное хранилище KYC, соблюдая требований GDPR. Обратите внимание, что данные KYC должны быть зашифрованы банком, и только он может напрямую получить доступ к данным хранилища. Если данные KYC хочет получить сторонняя организация, ей необходимо связаться с банком, который, прежде чем предоставить эти данные, запросит одобрение пользователя.
3. Провайдер KYC получает доступ к данным пользователя и проводит процедуру KYC (таким провайдером может быть как сам банк, так и сторона, которой банк доверяет проведение данной процедуры).
4. После этого провайдер KYC передает в банк результаты прохождения процедуры KYC. Если процедура не удалась, банк информирует пользователя об этом, а пользователь добавляет недостающие данные и повторяет шаг 1.
5. Если процедура KYC была успешно завершена, банк создает транзакцию, которая содержит открытый ключ пользователя (который подписан ключом банка) и значение хэш-функции от всех пользовательских данных (как доказательство хранения этих данных). Также он добавляет в транзакцию информацию о том, что он эти данные подтвердил. Узлы-валидаторы обрабатывают транзакцию и добавляют ее в цепочку блоков.
6. Банк возвращает Алисе подписанную транзакцию. Алиса может проверить, что соответствующая запись была добавлена в цепочку блоков и что данные в транзакции соответствует отправленным ею данным.
7. Если Боб хочет изменить свой открытый ключ, он информирует об этом свой орган идентификации (в нашем примере это центр сертификации пенсионного фонда).
8. Пенсионный фонд создает транзакцию, которая содержит информацию об аннулировании ранее действующего сертификата, и добавляет ее в цепочку блоков. Валидаторы обрабатывают транзакцию и добавляют ее в цепочку блоков, в результате чего ранее установленный открытый ключ становится недействительным для всех участников системы. 

Теперь давайте рассмотрим, как можно организовать использование идентификатора для доступа к сервисам других организаций (рис. 1.18).

![Рисунок 1.18 – Процесс получения доступа к сервисам при использовании полученного идентификатора](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.18-gaining-access-to-services.png "Рисунок 1.18 – Процесс получения доступа к сервисам при использовании полученного идентификатора")

1. Предварительно банк добавляет событие идентификации Алисы в распределенную базу данных, как мы описали выше.
2. Алиса хочет взаимодействовать с пенсионным фондом. Она не зарегистрирована в нем, но пенсионный фонд также является узлом в системе идентификации. Алиса формирует запрос к пенсионному фонду, в который включает свой идентификатор (открытый ключ), и подписывает запрос личным ключом, подтверждающим право собственности на идентификатор.
3. Пенсионный фонд проверяет подтверждение идентификатора Алисы в распределенной базе. Если пенсионный фонд доверяет банку относительно идентификации и сертификации пользователей, он предоставляет соответствующую услугу Алисе.
4. Если пенсионный фонд недостаточно доверяет банку (например, банк является молодой компанией), он может запросить идентификационные данные Алисы у банка (если Алиса дает на это свое согласие).
5. В этом случае банк извлекает данные из хранилища и передает их в пенсионный фонд. Обратите внимание, что Алиса должна предоставить разрешение на доступ к ее персональным данным во время формирования запроса к пенсионному фонду.
6. Пенсионный фонд получает данные и может проверить их достоверность (хэш от данных, хранящихся в распределенной базе), после чего фонд предоставляет Алисе доступ к его услугам.
7. Пенсионный фонд обязан хранить эту информацию, поэтому он должен сразу получить ее и сохранить в своем собственном хранилище.


### Digital identity для IoT

Существует девять основных применений IoT (рис. 1.19) [78].

![Рисунок 1.19 – Области использования Internet of things](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.19-IoT-application-areas.png "Рисунок 1.19 – Области использования Internet of things")

С помощью технологии блокчейн возможно организовать систему идентификации, которая применима везде: в области электронного здравоохранения для надежного обмена информацией об элементах медицинского оборудования, в промышленности – для аутентификации данных, ее компонентов и производителей, и т. д. В качестве примера рассмотрим возможный способ организации системы идентификации, содержащей информацию о датчиках автомобиля (рис. 1.20).

![Рисунок 1.20 – Использование системы идентификации для организации инфраструктуры для IoT](/resources/img/volume-3/1.2-Decentralized-digital-identity-systems/F-1.20-identification-system-with-IoT-infrastructure.png "Рисунок 1.20 – Использование системы идентификации для организации инфраструктуры для IoT")

1. Производители датчиков размещают идентификаторы и открытые ключи своей продукции в системе идентификации.
2. Датчики передают информацию с бортового компьютера автомобиля (при этом подписывая все передаваемые сообщения).
3. Бортовой компьютер обращается к распределенному реестру и проверяет действительность открытых ключей датчиков.
4. На основании полученной информации бортовой компьютер подает команды на механизмы автомобиля.
5. Допустим, Ева хочет отправить ложную информацию от имени одного из датчиков.
6. Компьютер запрашивает открытый ключ, который соответствует полученному идентификатору. Поскольку в системе отсутствует identity Евы (а если и присутствует, то к ней привязано другое значение открытого ключа), бортовой компьютер не будет обрабатывать полученный запрос.

### \*\*\*Часто задаваемые вопросы\*\*\*

_– Может ли децентрализованная система поддерживать многофакторную аутентификацию и как это будет работать, если в качестве первого фактора я хочу использовать знание, а в качестве второго фактора – свои биометрические данные?_

Децентрализованная система идентификации может поддерживать многофакторную аутентификацию, при этом процесс будет разделен несколько этапов. На первом вы, например, проходите аутентификацию у первого провайдера (вводите секретный PIN-код). Однако для децентрализованной системы не будет достаточно подтверждения только от одного провайдера, поэтому вам необходимо будет дополнительно пройти биометрическую аутентификацию с участием второго провайдера (который хранит ваши биометрические данные). Таким образом, только по прохождении нескольких подтверждений децентрализованная система будет уверена в том, что вы являетесь пользователем, за которого себя выдаете.

_– Какие алгоритмы достижения консенсуса применимы для систем идентификации, использующих технологии blockchain?_

Поскольку пользователи этих систем проходят идентификацию, это permissioned среда. Для достижения консенсуса в такой среде, как правило, используются такие алгоритмы: BFT, FBA, DPoS, PoA.


## 1.3 Децентрализованные платформы электронного голосования

В простейшем случае голосование можно определить как способ принятия коллективного решения, который предусматривает формирование общего мнения на основе подсчета голосов членов определенной группы. В этом подразделе мы рассмотрим несколько способов организации электронного голосования, преимущества и недостатки описанных подходов, а также использование этих подходов на практике.


### Проблемы традиционных подходов к проведению голосования

Традиционные подходы к голосованию можно считать достаточно эффективными и безопасными, только когда дело касается опроса среди жильцов одного дома по поводу цвета входной двери или выбора капитана команды во время занятия спортом. В контексте более масштабных и требовательных мероприятий, таких как общенациональные выборы или референдумы, они никогда не являлись таковыми; просто до определенного времени не было лучших альтернативных способов организовать голосование в перечисленных сферах.

Таким подходам свойственны такие недостатки и ограничения:

> * _Непрозрачность процедуры подсчета голосов_
> * _Возможность наличия фиктивных избирателей_
> * _Псевдоанонимность голосующих_
> * _Возможность искажения голосов в бюллетенях_

Первое ограничение состоит в том, что подсчет голосов на платформе голосования выполняется в доверенной закрытой среде. Избиратель вынужден доверять тем, кто формирует и объявляет результаты голосования, и не может самостоятельно убедиться в том, что его голос учтен правильно (рис. 1.21).

![Рисунок 1.21 – Непрозрачность процедуры подсчета голосов](/resources/img/volume-3/1.3-Decentralized-e-voting-platforms/F-1.21-non-transparency-of-vote-counting-procedure.png "Рисунок 1.21 – Непрозрачность процедуры подсчета голосов")

В контексте второго ограничения напрашивается аналогия с «мертвыми душами»: база данных избирателей может быть в неактуальном состоянии на момент проведения голосования и, более того, есть риск, что голосовать могут несуществующие пользователи. То есть необходим надежный источник данных о голосующих, роль которого фактически может выполнять отдельный орган (как это реализовано сейчас) либо система идентификации (как это наиболее целесообразно реализовать).

Ввиду наличия третьего ограничения в традиционных подходах личность голосующего может быть раскрыта и, кроме того, на голосующего может быть оказано давление, чтобы он отдал голос за «правильного» кандидата (рис. 1.22). Это давление также может быть выражено в подкупе избирателя, угрозе физического насилия, порче профессиональной репутации и т. п.

![Рисунок 1.22 – Псевдоанонимность голосующего](/resources/img/volume-3/1.3-Decentralized-e-voting-platforms/F-1.22-pseudo-anonymity-of-voter.png "Рисунок 1.22 – Псевдоанонимность голосующего")

Четвертое ограничение связано с тем, что после голосования остается часть незаполненных бюллетеней: ведь некоторые избиратели по собственному желанию не участвуют в голосовании. Заполнив эти бюллетени, можно незаконно привлечь дополнительные голоса за «нужного» кандидата. Здесь же стоит учитывать, что, испортив действительные бюллетени, можно избавиться от настоящих голосов. Вдобавок, известны случаи, когда на избирательном участке использовались ручки с исчезающими чернилами [18].

Отметим, что множество голосований в наши дни до сих пор проходит в нецифровой (ручной) форме. Помимо их неэффективности и небезопасности, они требуют больших финансовых затрат. Однако существуют и системы электронного голосования; несколько примеров таких систем мы рассмотрим далее.


### Электронное голосование в Эстонии

В 2005 году Эстония стала первым государством в мире, которое провело общенациональные выборы с использованием электронного голосования, а в 2007 году она использовала его во время парламентских выборов [19]. Возможность проголосовать в электронном виде была введена дополнительно к традиционному способу голосования (на избирательном участке с бумажным бюллетенем).

I-Voting (Internet-voting, интернет-голосование) – это система, которая позволяет избирателям голосовать в любой точке мира, используя необходимое ПО. Фактически, решалась проблема, которая состояла в том, что при использовании любого метода дистанционного голосования, включая традиционные почтовые бюллетени, существует возможность принудительного или купленного голосования. Решение Эстонии состоит в том, чтобы позволить избирателям входить в систему и голосовать несколько раз в период предварительного голосования. Поскольку каждый голос отменяет предыдущий, избиратель имеет возможность изменить свой голос, если перед этим он голосовал вынужденно; но при каждой попытке проголосовать повторно система запрашивает у пользователя подтверждение этого действия [19].

Инфраструктура системы I-Voting показана на рис. 1.23. Она включает следующие компоненты:

* Клиент голосования (Voting Client)
* Приложение проверки голоса (Verification App)
* Сервер пересылки голосов (Vote Forwarding Server)
* Сервер журналирования (Log Server)
* Сервер хранения голосов (Vote Storage Server)
* Сервер подсчета голосов (Vote Counting Server)
* Аппаратный модуль безопасности (HSM)

![Рисунок 1.23 – Инфраструктура системы I-Voting](/resources/img/volume-3/1.3-Decentralized-e-voting-platforms/F-1.23-I-Voting-system-infrastructure.png "Рисунок 1.23 – Инфраструктура системы I-Voting")

Для участия в процедуре голосования I-Voting необходимо загрузить на компьютер клиентское приложение; оно содержит предназначенный для выборов открытый ключ для шифрования голоса (PK<sub>elect</sub>) и сертификат TLS для сервера пересылки. В течение периода предварительного голосования избиратель входит в систему, используя ID-карту или Mobile-ID. 

Клиентское ПО проверяет identity сервера при помощи ранее упомянутого сертификата, а сервер, исходя из открытого ключа избирателя, подтверждает его право голосовать и отображает для него соответствующий список кандидатов (_C_).

Избиратель совершает выбор _c_. После этого клиент осуществляет дополнение голоса _c_ по алгоритму RSA-OAEP [20] и зашифровывает его конкретным открытым ключом выборов (PK<sub>elect</sub>). Для зашифрованного голоса (_b_), пользователь вычисляет подпись (_σ_) при помощи своего личного ключа (SK<sub>voter</sub>).

Сервер получает зашифрованный и подписанный голос _v_, связывает его с уникальным идентификатором _x_ и возвращает _x_ клиенту (рис. 1.24) [21]

![Рисунок 1.24 – Процесс передачи голоса](/resources/img/volume-3/1.3-Decentralized-e-voting-platforms/F-1.24-vote-casting.png "Рисунок 1.24 – Процесс передачи голоса")

Избиратель может проверить, был ли его голос правильно записан на сервере голосования, при помощи отдельного приложения. Отсканировав код QR, который показывает клиент для голосования, это приложение получает _r_ и _x_, после чего отправляет _x_ на сервер пересылки и получает от него _b_ and _C_. Для каждого варианта голоса _c'_, оно вычисляет зашифрованную форму и сравнивает ее с полученным ранее _b_; если совпадение найдено, тогда приложение показывает избирателю _c'_, иначе сообщает об ошибке. Сервер позволяет провести такую проверку трижды для голоса в течение тридцати минут после того, как голос был отдан (рис. 1.25) [21].


![Рисунок 1.25 – Процесс проверки голоса](/resources/img/volume-3/1.3-Decentralized-e-voting-platforms/F-1.25-vote-verification.png "Рисунок 1.25 – Процесс проверки голоса")

> _Замечание. Во время выполнения процедуры, описанной выше, избиратель может проверить, что он не допустил ошибку при выборе варианта голоса. Впрочем, он не может убедиться, что его голос впоследствии будет правильно учтен в результатах выборов._

После окончания онлайн-голосования сервер хранения перепроверяет подписи зашифрованных голосов и аннулирует невалидные и устаревшие голоса. Цифровая подпись избирател (_σ_) отделяется от голоса (_b_) до того, как он поступает на сервер подсчета голосов, что обеспечивает анонимность избирателя (то есть сервер хранения не передает цифровые подписи на сервер подсчета). Набор анонимных зашифрованных голосов (_B_) переносят на сервер подсчета. Сервер подсчета использует аппаратный модуль безопасности, который содержит личный ключ выборов (SK<sub>elect</sub>) для расшифрования голосов и подсчитывает голоса за каждого кандидата (_counts_[_c_]). Итог подсчета электронных голосов (_counts_) объединяется с итогом ручного голосования и публикуется как общий результат выборов [21]. Эти действия выполняет избирательная комиссия (рис. 1.26).

![Рисунок 1.26 – Процесс подсчета голосов](/resources/img/volume-3/1.3-Decentralized-e-voting-platforms/F-1.26-vote-counting.png "Рисунок 1.26 – Процесс подсчета голосов")

Результаты электронного голосования не публикуются до конца голосования в день выборов (день ручного голосования). После подсчета голосов (как правило, на следующий день) голоса повторно пересчитывают для проверки. Чтобы итог подсчета можно было проверить публично, электронные голоса смешиваются и переупорядочиваются. Во время аудита данных аудитор также проверяет целостность ящика для бюллетеней, правильность аннулирования повторных голосов и анонимизации голосов. Как и аудитор, сторонние наблюдатели также могут проводить аналогичные процедуры проверки [22].


### Электронное голосование в Швейцарии

В Швейцарии с 2003 года было проведено более 200 попыток внедрения электронного голосования в различных кантонах. Тем не менее, электронное голосование все еще не стало постоянным явлением; в ноябре 2018 года право голосовать в электронном виде было менее, чем у 4% зарегистрированного населения. Для сравнения: в Эстонии в 2017 году 31% всех голосов было отдано в электронном виде [23].

За прошедшие годы были опробованы две системы. Первая из них была собственной разработкой кантона Женева. Несколько других кантонов ее также пытались внедрить, однако в 2018 году было объявлено, что эта система преждевременно прекратит свою работу из-за высоких затрат на ее поддержание [23].

Вторая система – Swiss Post – это разработка испанской группы Scytl. В двух кантонах систему используют с 2016 и 2017 года соответственно и для федеральных голосований, и для местных выборов [24].

Электронное голосование с использованием системы Swiss Post задумано как дополнительный канал голосования, который предлагается наряду с голосованием по почте и ручным голосованием. Процесс голосования проиллюстрирован на рис. 1.27; он состоит из следующих этапов:

1. Формирование бюллетеней (определение предмета голосования и списка вариантов голоса).
2. Генерация кодов доступа и подтверждения.
3. Подготовка и доставка материалов для голосования.
4. Зашифрование урны для бюллетеней и разделение ключей.
5. Голосование (заполнение и отправка бюллетеней).
6. Доставка запечатанной урны для бюллетеней.
7. Расшифрование урны и подсчет электронных голосов.
8. Опубликование результатов и статистики.

Система Swiss Post (в центре) непосредственно взаимодействует с голосующим на шагах 3 и 5. С органом власти – на шагах 1, 4 и 6.

![Рисунок 1.27 – Цикл голосования с использованием системы Swiss Post](/resources/img/volume-3/1.3-Decentralized-e-voting-platforms/F-1.27-voting-with-Swiss-Post-system.png "Рисунок 1.27 – Цикл голосования с использованием системы Swiss Post")

По состоянию на октябрь 2019 года в Швейцарии не внедрена постоянно действующая система электронного голосования. К этому моменту правительство лишь планировало, чтобы по меньшей мере 18 из 26 кантонов предоставляли возможность проголосовать в электронном виде на парламентских выборах [23].

### Децентрализованный подход к проведению электронного голосования

Децентрализованный подход может улучшить процесс голосования, повышая надежность, безопасность и стойкость системы голосования. Рассмотрим несколько важных свойств, которые может привнести этот подход:

> * _Возможность проверки правильности подсчета голоса_
> * _Отказоустойчивость системы_
> * _Анонимность голосующих_
> * _Возможность проверки подлинности голосов_
> * _Защита от подделывания голосов_

Далее мы рассмотрим один из примеров децентрализованного голосования.


### Пример схемы голосования без центрального органа

Мы рассмотрим протокол, не использующий центральный орган, который создал М. Мерритт в 1982 году [25]. Предположим, что Алиса, Боб, Кэрол и Дейв голосуют относительно чего-либо. Пусть у каждого избирателя есть пара ключей (открытый и личный), а также их открытые ключи известны друг другу (рис. 1.28).

![Рисунок 1.28 – Участники голосования](/resources/img/volume-3/1.3-Decentralized-e-voting-platforms/F-1.28-voting-participants.png "Рисунок 1.28 – Участники голосования")

Пусть _E_ – это функция зашифрования, _R_ – случайная строка, а _V_ – строка, содержащая голос (например, номер варианта ответа). Для удобства выделим в этом протоколе такие этапы: формирование голосов, отправка голосов, подтверждение и подсчет голосов.

На этапе формирования голосов каждый избиратель совершает такие действия (рис. 1.29):

1. Добавляет случайную строку _R<sub>0</sub>_ (salt) к своему голосу.
2. Шифрует результат шага 1 открытым ключом Дейва.
3. Шифрует результат шага 2 открытым ключом Кэрол.
4. Шифрует результат шага 3 открытым ключом Боба.
5. Шифрует результат шага 4 открытым ключом Алисы.
6. Добавляет случайную строку _R<sub>1</sub>_ к результату шага 5 и шифрует полученное открытым ключом Дейва.
7. Добавляет случайную строку _R<sub>2</sub>_ к результату шага 6 и шифрует полученное открытым ключом Кэрол.
8. Добавляет случайную строку _R<sub>3</sub>_ к результату шага 7 и шифрует полученное открытым ключом Боба.
9. Добавляет случайную строку _R<sub>4</sub>_ к результату шага 8 и шифрует полученное открытым ключом Алисы.

![Рисунок 1.29 – Схема формирования голоса](/resources/img/volume-3/1.3-Decentralized-e-voting-platforms/F-1.29-vote-configuration.png "Рисунок 1.29 – Схема формирования голоса")

Конечное сообщение избирателя будет выглядеть так: $E_{\text{A}}(R_{4} \Vert E_{\text{B}}(R_{3} \Vert E_{\text{C}}(R_{2} \Vert E_{\text{D}}(R_{1} \Vert E_{\text{A}}(E_{\text{B}}(E_{\text{C}}(E_{\text{D}}(V \Vert R_{0}))))))))$. Каждый голосующий сохраняет все промежуточные результаты на каждом шаге вычислений. Эти результаты будут использоваться в дальнейших шагах протокола для подтверждения, что голос конкретного избирателя будет подсчитан.

Этап отправки голосов подразумевает такую последовательность действий (рис. 1.30):

1. Каждый голосующий отправляет зашифрованный голос Алисе.
2. Алиса расшифровывает все голоса, используя свой личный ключ, удаляет все случайные строки на этом уровне, перетасовывает все голоса и посылает результат Бобу. Теперь каждый голос будет выглядеть следующим образом: $E_{\text{B}}(R_{3} \Vert E_{\text{C}}(R_{2} \Vert E_{\text{D}}(R_{1} \Vert E_{\text{A}}(E_{\text{B}}(E_{\text{C}}(E_{\text{D}}(V \Vert R_{0})))))))$.
3. Боб расшифровывает все голоса, используя свой личный ключ, проверяет, есть ли его голос среди присланных голосов, удаляет все случайные строки на этом уровне, тасует голоса и посылает результат Кэрол. Теперь каждый голос будет выглядеть так: $E_{\text{C}}(R_{2} \Vert E_{\text{D}}(R_{1} \Vert E_{\text{A}}(E_{\text{B}}(E_{\text{C}}(E_{\text{D}}(V \Vert R_{0}))))))$.
4. Кэрол расшифровывает все голоса, используя свой личный ключ, проверяет, есть ли ее голос среди присланных голосов, удаляет все случайные строки на этом уровне, тасует голоса и посылает результат Дейву. Теперь каждый голос будет иметь следующий вид: $E_{\text{D}}(R_{1} \Vert E_{\text{A}}(E_{\text{B}}(E_{\text{C}}(E_{\text{D}}(V \Vert R_{0})))))$.
5. Дейв расшифровывает все голоса, используя свой личный ключ, проверяет, есть ли его голос среди присланных голосов, удаляет все случайные строки на этом уровне, тасует голоса и посылает результат Алисе. Теперь каждый голос будет выглядеть следующим образом: $E_{\text{A}}(E_{\text{B}}(E_{\text{C}}(E_{\text{D}}(V \Vert R_{0}))))$.

![Рисунок 1.30 – Схема передачи голоса](/resources/img/volume-3/1.3-Decentralized-e-voting-platforms/F-1.30-vote-submission.png "Рисунок 1.30 – Схема передачи голоса")

Дальнейшие действия относятся к этапу подтверждения и подсчета голосов (рис. 1.31):

1. Алиса расшифровывает все голоса, используя свой личный ключ, проверяет, есть ли ее голос среди присланных голосов, подписывает все голоса и посылает результат Бобу, Кэрол и Дейву. Теперь каждый голос будет выглядеть так: $S_{\text{A}}(E_{\text{B}}(E_{\text{C}}(E_{\text{D}}(V \Vert R_{0}))))$.
2. Боб проверяет и удаляет подписи Алисы. Он расшифровывает все голоса, используя свой личный ключ, проверяет, есть ли его голос среди присланных голосов, подписывает все голоса и посылает результат Алисе, Кэрол и Дейву. Теперь каждый голос будет выглядеть следующим образом: $S_{\text{B}}(E_{\text{C}}(E_{\text{D}}(V \Vert R_{0})))$.
3. Кэрол проверяет и удаляет подписи Боба. Она расшифровывает все голоса, используя свой личный ключ, проверяет, есть ли ее голос среди присланных голосов, подписывает все голоса и посылает результат Алисе, Бобу и Дейву. Теперь каждый голос будет выглядеть следующим образом: $S_{\text{C}}(E_{\text{D}}(V \Vert R_{0}))$.
4. Дейв проверяет и удаляет подписи Кэрол. Он расшифровывает все голоса, используя свой личный ключ, проверяет, есть ли его голос среди присланных голосов, подписывает все голоса и посылает результат Алисе, Бобу и Кэрол. Теперь каждый голос будет выглядеть следующим образом: $S_{\text{D}}(V \Vert R_{0})$.
5. Все проверяют подпись Дейва. Они убеждаются, что их голоса находятся среди полученных (находя свою случайную строку).
6. Все удаляют случайные строки из каждого голоса и подсчитывают голоса. Таким образом каждый участник получает собственный результат голосования.

![Рисунок 1.31 – Схема подтверждения и подсчета голосов](/resources/img/volume-3/1.3-Decentralized-e-voting-platforms/F-1.31-vote-confirmation-and-tallying.png "Рисунок 1.31 – Схема подтверждения и подсчета голосов")

Алиса, Боб, Кэрол и Дейв немедленно узнают, если кто-нибудь из них попытается мошенничать. Чтобы обнаружить мошенничество, здесь не нужно никаких центральных органов. Приведем пример с попыткой мошенничества, чтобы увидеть, как это работает.

Если кто-нибудь пытается добавить голос, Алиса обнаружит эту попытку на втором этапе голосования, когда она получит больше голосов, чем количество пользователей, участвующих в голосовании. Если Алиса попытается добавить голос, Боб также обнаружит это на втором этапе голосования.

Более ловкой является подмена одного голоса другим. Так как голоса шифруются различными открытыми ключами, каждый может создать столько правильных голосов, сколько нужно. На каждом этапе (2 и 3) подмена голоса на различных шагах обнаруживается по-разному.

Если кто-нибудь заменит один голос на третьем этапе голосования, его действия будут обнаружены сразу. На каждом шаге голоса подписываются и посылаются всем избирателям. Если избиратель обнаруживает, что его голоса больше нет среди набора голосов, он немедленно прекращает выполнение протокола. Поскольку в третьей части протокола голоса подписываются на каждом шаге и каждый может вернуться на несколько шагов назад, то обнаружить мошенника, подменяющего голоса, легко.

Замена одного голоса другим во второй части протокола утонченнее. Алиса не может сделать подмену, потому что Боб, Кэрол и Дейв обнаружат это на следующих шагах. Если Боб заменит голоса Кэрол и Дейва (помните, он не знает, кому какой голос принадлежит), Кэрол или Дейв заметят это далее (на своих шагах). Они не будут знать, кто подменил их голоса (хотя это должен быть кто-то, уже обработавший голоса), но они будут знать, что их голоса подменены. Если Бобу повезло, и ему удалось подменить голос Алисы, она не заметит этого до третьей части протокола. Тогда она обнаружит исчезновение своего голоса, но не сможет узнать, кто подменил его. На втором этапе голоса перетасовываются и не подписываются на каждом шаге, поэтому никто не сможет выполнить протокол в обратном направлении и определить, кто подменил голоса.

Другой формой мошенничества является попытка узнать, кто за кого проголосовал. Из-за перетасовки голосов во второй части никто не сможет выполнить протокол в обратном направлении и связать голоса и голосующих. Удаление случайных строк во второй части также является решающим для сохранения анонимности: если бы строки не удалялись, перемешивание голосов могло бы быть инвертировано при помощи повторного зашифрования получаемых голосов открытым ключом того, кто их тасовал. Когда протокол остановится, конфиденциальность голосов сохранится.

Более того, из-за начальной случайной строки (_R<sub>0</sub>_) даже одинаковые голоса шифруются по-разному на каждом шаге протокола. Никто не может узнать значение голоса на последнем шаге третьего этапа.

Каковы проблемы этого протокола? Во-первых, масштабируемость – для выполнения протокола нужно совершать громоздкие вычисления. В приведенном примере в голосовании принимают участие только четверо, но и он уже сложен. Такой протокол не сможет работать при реальных выборах с десятками тысяч голосующих.

Во-вторых, Дейв узнает результаты выборов раньше остальных. Хотя он и не может повлиять на результат, он получает определенное преимущество.

В-третьих, некоторый участник может скопировать голос другого участника, даже не зная его содержания заранее. Чтобы понять, почему это может стать проблемой, рассмотрим пример голосования для трех голосующих – Алисы, Боба и Евы. Предположим, что Еве не важны результаты голосования, но она хочет знать, как голосовала Алиса, и для этого копирует ее голос. В результатах большинство голосов гарантированно будет у варианта ответа, за который голосовала Алиса: либо 3 из 3, если Боб голосовал за тот же вариант ответа, либо 2 из 3, если иначе.


### Использование технологии blockchain для системы электронного голосования

Для применения децентрализованного электронного голосования к обычным выборам необходим протокол, который одновременно позволяет обеспечить прозрачность голосования и анонимность пользователей. Блокчейн как технология, на которой может (но не обязана) быть основана децентрализованная система, может обеспечить такие особенности:

> * _Избиратель может когда угодно убедиться, что его голос был подсчитан правильно_
> * _Наличие доказательства права голосовать и проверка целостности голоса благодаря использованию цифровых ключей и подписей_
> * _Подделка голоса невозможна, так как она сразу будет обнаружена в истории отправки голосов_

Первое и наиболее важное преимущество использования blockchain для организации платформы голосования состоит в том, что пользователь действительно может убедиться в том, что его голос был учтен правильно, и что результаты голосования опираются на проведенные транзакции. При этом могут использоваться методы обеспечения анонимности голосующих (например, кольцевые подписи или гомоморфное шифрование) с сохранением проверяемости результатов голосования.

Использование криптографических подписей и цепочки блоков позволяет обеспечить проверку подлинности и целостности всех отправленных транзакций. При этом важно обеспечить надежный источник информации об открытых ключах голосующих. Имея надежную инфраструктуру открытых ключей, каждый пользователь сможет проверить, что голосовали только уполномоченные участники, при этом информация относительно отправителя голоса может быть скрыта.

Голоса в этом случае также не могут быть изменены в будущем, поскольку такое изменение будет видно всем участникам сети, которые хранят историю транзакций (возможно, даже облегченным узлам). Если системе голосования необходимо предоставлять возможность переголосования, то это может осуществляться только посредством отправки новой транзакции.

Стоит отметить, что те платформы электронного голосования, которые можно назвать децентрализованными, в первую очередь нацелены на обеспечение возможности проверки результатов и того, был ли учтен голос конкретного участника. Это именно те свойства, которые не обеспечивают традиционные системы голосования.

### \*\*\*Часто задаваемые вопросы\*\*\*

_– Какие еще существуют методы обеспечения приватности пользователей в системах электронного голосования?_

В качестве одного из альтернативных вариантов обеспечения приватности можно использовать механизм кольцевых подписей. Если набор открытых ключей пользователей заранее известен, то голосующий может использовать открытые ключи из этого набора и свой личный ключ для формирования кольцевой подписи голоса. Напомним, что при проверке подписи такого типа верификатор может убедиться, что подпись была вычислена одним из участников группы, но при этом не может определить, кем именно.

_– Являются ли децентрализованными системы электронного голосования в Эстонии и Швейцарии? Если нет, то почему их рассматривают вне контекста традиционных подходов к голосованию?_

Обе рассмотренные системы не децентрализованные; обе предусматривают наличие центрального органа, который принимает и подсчитывает голоса (избирательной комиссии). Они сочетают традиционные способы организации голосования с возможностью проголосовать без бумажных бюллетеней и физического присутствия на избирательном участке (с голосованием в электронном виде).


## 1.4 Технологии децентрализованных бирж

Биржа – это площадка, где покупатели и продавцы могут заключать сделки между собой. Биржа может заниматься торговлей товарами (товарная биржа), ценными бумагами (фондовая биржа), валютой (валютная биржа), наймом рабочих (биржа труда) и другими видами деятельности. С появлением криптовалют и других цифровых активов возникла необходимость функционирования соответствующих бирж, которые поддерживают обмен таких активов на фиатные валюты и взаимный обмен.

Первыми возникли централизованные биржи. Они выступают посредниками и отвечают за хранение и управление всеми средствами, которые торгуются на платформе. Первая биржа, которая поддерживала bitcoin, – Bitcoinmarket.com – появилась 17 марта 2010 года [26].

> **_Проблемы централизованных бирж_**  
> * _Риски взлома площадок_
> * _Ключи от монет контролируются биржей_
> * _Риск запретов_
> * _Необходимость полного доверия бирже со стороны пользователей_

Основной недостаток – риск взлома платформы. Централизованные биржи более уязвимы перед мошенниками и хакерами, так как являются хорошей целью –  все средства хранятся централизованно (к тому же, отправка монет криптовалюты необратимая и достаточно сложно отслеживаемая без специальных средств), что упрощает задачу злоумышленнику (вместо дорогостоящих атак на конечных пользователей с небольшой выгодой, он атакует биржу). На рис. 1.32 можно оценить последствия наиболее известных взломов централизованных бирж [27–40].

![Рисунок 1.32 – Взломы централизованных бирж и последующие финансовые потери](/resources/img/volume-3/1.4-Decentralized-exchange-technologies/F-1.32-attacks-on-centralized-exchanges.png "Рисунок 1.32 – Взломы централизованных бирж и последующие финансовые потери")

Второй недостаток состоит в том, что ключи от монет контролируются биржей, а это значит, что пользователь должен полностью доверять самой бирже. Именно поэтому биржа может ограничить пользователей при попытке вывода средств с платформы. И очень часто пользователи тратят много сил и средств для восстановления доступа к монетам после получения сообщения «Вывод средств временно отключен для этого счета» [41].

Помимо этого, существует риск государственных (и не только) запретов и ограничений. У биржи могут изъять сервера, да и сама биржа может заблокировать счета жителей какой-то страны из-за политической ситуации. Самые громкие запреты и репрессии произошли в Китае и в Корее [42]. Например, китайские власти закрыли биржу криптовалют BISS (мотивируя это нарушением законодательства страны) и арестовали десять человек, подозреваемых в причастности к ее операциям в ноябре 2019 года [43].

Отметим, что централизованная биржа работает только с верифицированными пользователями, поэтому свойство анонимности на этом этапе в большинстве случаев будет утеряно. Пользователи должны соблюдать требования KYC, которые подразумевают предоставление документов, удостоверяющих их личность.

Отсюда возникает другой риск – утечка персонально идентифицируемой информации (PII) через централизованные биржи. В 2018 году была опубликована информация о продаже данных пользователей таких бирж: Bittrex, Poloniex, Bitfinex и Binance [44]. Упомянутые выше факты показывают, что для людей стало гораздо более опасно использовать централизованные биржи.


### Принципы функционирования децентрализованных бирж

Альтернативой, решающей перечисленные проблемы, могут стать _децентрализованные биржи_ (рис. 1.33). Такие платформы позволяют пользователям сохранять контроль над средствами и занимаются только сопоставлением ордеров пользователей, желающих обменяться (а иногда и обеспечением безопасности данных обменов). Разница между моделями работы централизованных и децентрализованных бирж несколько похожа на разницу между централизованными и децентрализованными пиринговыми файлообменными системами.

![Рисунок 1.33 – Отличие функционирования централизованных и децентрализованных бирж](/resources/img/volume-3/1.4-Decentralized-exchange-technologies/F-1.33-difference-in-operation-of-exchanges.png "Рисунок 1.33 – Отличие функционирования централизованных и децентрализованных бирж")

В отличие от централизованной, децентрализованная биржа не хранит ключи от средств пользователей, а является лишь платформой для проведения транзакций без посредников, то есть отсутствует какая-либо централизованная сторона, которая контролирует и обеспечивает функционирование децентрализованной биржи. Существует несколько подходов к организации децентрализованных бирж.

> * _Escrow_
> * _Atomic swap_
> * _Smart contracts_
> * _Internal exchanges_

Следует понимать, что децентрализованные биржи – это не одна конкретная технология. Существует много бирж и много соответствующих технологий. Прежде всего их стоит различать по способу организации процессов, таких как создание order book, хранение order book, управление доступом к order book, а также _order matching_. Существуют такие децентрализованные биржи, где часть процессов выполняют вручную сами пользователи. Например, такими процессами могут быть обмен открытыми ключами для создания промежуточных адресов или аудит смарт-контрактов, гарантирующих совершение или отмену обмена. Исходя из этого, DEX можно разделить как минимум на две группы:

* С on-chain order book
* С off-chain order book

В идеальном случае децентрализованная биржа могла бы работать с неограниченным количеством цифровых валют, с неограниченным количеством пользователей (торговцев) и позволяла бы совершать trustless обмены. Такая децентрализованная биржа была бы одна, потому что большее количество было бы не нужно. В этом контексте наиболее подходящая технология – atomic swap в сочетании с открытой системой создания order book. Впрочем, это лишь идеальный вариант децентрализованной биржи; на практике люди лишь пытаются достичь чего-то похожего.


### Escrow

_Счет escrow_ – это специальный счет для безопасного проведения расчетов между покупателем и продавцом. Его еще называют _условный счет_, потому что средства с него можно перевести лишь после выполнения определенных условий. При таком взаимодействии покупатель кладет деньги на счет escrow, а продавец может их забрать, когда выполнит условия, заранее прописанные в договоре. Безопасность функционирования данного подхода лежит на независимом посреднике, который следит за выполнением условий.

Подобные счета чаще всего используются при обмене криптовалюты на фиатные валюты, однако они же могут использоваться при обмене одной криптовалюты на другую. Обмен происходит по такому принципу: криптовалюта удерживается до тех пор, пока не будет осуществлен платеж. Например, два человека, которые хотят обменяться долларами и биткоинами, находят друг друга. В таком случае выбирается посредник, который будет следить за тем, чтобы сделка проходила честно для обеих сторон. Вместе они создают MultiSig-адрес 2-из-3 (счет escrow). Один ключ будет принадлежать тому, кто хочет получить доллары, второй – тому, кто хочет получить биткоины, а третий – посреднику. Для совершения транзакции достаточно двух подписей: либо стороны договариваются между собой, либо, в случае возникновения спора, посредник принимает позицию одной из сторон и помогает решить разногласия (за соответствующее вознаграждение). Одна из бирж, которая реализовывает данную технологию, – BitSquare.


### Atomic swap

Atomic swap – это технология, которая позволяет совершить обмен одного цифрового актива на другой без централизованных посредников. Обязательные условия для совершения atomic swap: обмениваемые валюты должны иметь одинаковый алгоритм хэширования и должны поддерживать контракты с блокировкой по хэшу и времени (HTLC). Мы уже детально рассматривали функционирование atomic swap во второй части учебного пособия.

Не все криптовалюты поддерживают atomic swap, что является некоторым недостатком данной технологии. К тем системам, которые на текущий момент поддерживают эту технологию, относятся Bitcoin, Ethereum и другие похожие системы. Отметим, что до сих пор не существует единого стандарта для atomic swap. Все системы, которые на текущий момент поддерживают atomic swaps, используют криптографию и смарт-контракты без единого стандарта.

> _Замечание. Первые упоминания об этой технологии датируются 2013 годом. Однако только 20 сентября 2017 разработчики Decred создали первый смарт-контракт, используя SCRIPT, чтобы позволить атомарный обмен между Decred и Litecoin [45]._

Пример биржи, которая использует данные технологии – _BarterDEX_ [46]. BarterDEX – это децентрализованная биржа построенная на платформе Komodo, которая использует технологии atomic swap.

> _Замечание. Komodo использует алгоритм достижения консенсуса delayed proof-of-work (dPoW). dPoW включает механизм, который нотариально заверяет блоки в цепочке. Этот алгоритм подразумевает хранение резервных копий транзакций в выбранной цепочке блоков, чтобы в случае атаки на Komodo всю историю можно было восстановить. Эта возможность достигается посредством добавления в блок «снимка» текущего состояния системы._

Биржа BarterDEX поддерживает более 100 различных монет и токенов, среди которых Bitcoin-based валюты, Ethereum-based валюты, токены, выпущенные на платформе Ethereum. Ограничение этой платформы – невозможность проведения обменов между цифровыми и фиатными валютами.

Важная особенность платформы состоит в том, что _order book_ также децентрализован. Для функционирования order book BarterDEX поддерживает пользовательскую peer-to-peer сеть, которая использует два типа узлов: _full-relay node_ и _non-relay node_.

Основное отличие между типами узлов заключается в том, что full-relay node обычно является пользователем с большим объемом продаж, который обеспечивает ликвидность в обмен на то, чтобы быть trading hub в сети. Это позволяет ему совершать сделки быстрее, чем его торговые конкуренты. Non-relay nodes являются узлами конечных пользователей, которые используют BarterDEX при обмене одного цифрового актива на другой.


### 0x protocol

Проект был основан в октябре 2016 года [47]. _0x_ – это не платформа, реализующая децентрализованную биржу. Это открытый permissionless протокол (контракт) для децентрализованного обмена, который функционирует в Ethereum.

Все обмены проходят off-chain. В самой цепочке записываются только результаты взаимодействия в виде транзакции. Записи в цепочке содержат только данные об изменениях прав собственности (прочие данные в цепочку не попадают).

Обмен проходит согласно таким шагам:

1. Пользователь создает order, описывает желаемый обменный курс и срок его действия (после которого order не может быть исполнен), после чего подписывает его личным ключом.
2. Далее ему нужно найти другого пользователя, с которым он может обменяться. Если такой пользователь заранее определен, то можно просто отправить ордер _0x_ напрямую (т. е. по электронной почте, через чат или внебиржевую платформу). Если же контрагент еще не найден, то заказ отправляется к relayer. Relayer ведет книгу заказов вне цепочки блоков. С помощью них пользователи могут находить, создавать, выполнять или отменять ордеры. Relayer также может общаться с другими relayer-узлами и создавать набор заказов для увеличения ликвидности (рис. 1.34).

![Рисунок 1.34 – Отправка orders relayer-узлам](/resources/img/volume-3/1.4-Decentralized-exchange-technologies/F-1.34-sending-orders-to-relayer-nodes.png "Рисунок 1.34 – Отправка orders relayer-узлам")

3. Как только кто-то находит ордер и желает осуществить по нему обмен, он отправляет в цепочку блоков ордер вместе с суммой, которую он желает заполнить. В отличие от биржи, relayer не проводит сделку. Он может только облегчить торги, представляя ордера пользователей, транслируемые в сеть.
4. Покупатель отправляет смарт-контракту децентрализованной биржи свою подпись вместе с подписью создателя ордера.
5. Контракт проверяет цифровую подпись пользователей и выполняет все условия сделки. Если все верно, то будет произведен атомарный обмен задействованных активов между двумя пользователями. Если какое-либо из условий заказа не будет выполнено, заявка на выполнение ордера будет отклонена.

> _Замечание. Как мы упоминали ранее, в 0x существует два типа ордеров: broadcast order и point-to-point order. Первый аналогичен обычному ордеру на бирже: пользователь отправляет в сеть заявку о том, что готов купить (продать) определенную сумму токенов по указанной цене. Второй же подразумевает наличие предварительной договоренности о купле-продаже между держателями двух конкретных аккаунтов. Эта схема позволяет совершать обмен по множеству каналов, включая e-mail и мессенджеры. Инициатор сделки отправляет на relayer-узел свою заявку, а откликнуться на неё может лишь владелец указанного в ней аккаунта._


### Internal exchanges

Internal exchange – это биржа, которая функционирует в рамках учетной системы и позволяет пользователям обмениваться между собой правами собственности на учитываемые в этой системе активы. Биржи этого типа функционируют на платформах Stellar и Bitshares.

Система Stellar может использоваться для хранения и передачи прав собственности на любой актив: на доллары, евро, биткоины, акции, золото и другие. Любой актив в ней можно обменять на любой другой.

Представим, что пользователь хочет обменять BTC на ETH.

1. Пользователь создает offer, который затем проверяется на соответствие в order book для заданной пары активов. 
2. Если находится соответствие, то совершается сделка. В противном случае offer сохраняется в order book и находится там до тех пор, пока не будет создан соответствующий ему order, либо пока он не будет отменен пользователем. 
3. Возможен вариант, когда обмен будет совершаться не в одну операцию. Если же order book обмена имеет очень большой разброс или вовсе не существует, тогда можно получить больше выгоды, если совершить обмен в несколько ходов (рис. 1.35). Например, если хотим обменять актив BTC на ETH, то можно сначала обменять BTC на XLM, и только потом – XLM на ETH.

![Рисунок 1.35 – Обмен с несколькими посредниками](/resources/img/volume-3/1.4-Decentralized-exchange-technologies/F-1.35-exchange-through-several-intermediaries.png "Рисунок 1.35 – Обмен с несколькими посредниками")

Эти пути конвертации активов могут содержать до 6 прыжков (hops), но весь платеж атомарный – он будет либо успешным, либо ни один из переводов не будет выполнен (отправитель платежа никогда не останется с ненужным ему активом). Процесс поиска лучшего пути оплаты называется pathfinding. Поиск пути включает в себя просмотр текущих заказов и поиск серии обменов, которая обеспечивает наиболее выгодную сделку.

> _Замечание. Internal exchange в Bitshares имеет собственный on-chain order book. Чтобы совершить обмен, необходимо создать транзакцию, где пользователь заявляет, что готов менять один актив на другой. Затем эта транзакция распространяется по сети и получает подтверждение, после чего другой пользователь может таким же образом заявить, что хочет менять те же активы в том же соотношении. В момент подтверждения второй транзакции, согласно протоколу, обновляются балансы обоих пользователей. Принципы функционирования Bitshares мы рассматривали во второй части этого учебного пособия._

### \*\*\*Часто задаваемые вопросы\*\*\*

_– Почему внутренние биржи учетных систем Bitshares и Stellar тоже называют децентрализованными биржами (DEX), хотя они существуют только в рамках одной учетной системы и не поддерживают активы других систем?_

Дело в том, что вариант внутренних бирж появился гораздо раньше, чем метод atomic swap и идея trustless обменов между разными учетными системами. Тем более, если все процессы внутренней биржи децентрализованы, то ее по определению можно назвать DEX. Также можно отметить, что у внутренней биржи есть ряд преимуществ по сравнению с биржей на основе atomic swap. Например, меньшее время подтверждения, отсутствие необходимости прямого взаимодействия участников сделки, завершение сделки без участия пользователя, обычно меньшее количество транзакций и комиссий для выполнения одной сделки.

_– Что при обмене с помощью Stellar гарантирует, что пользователь не останется с промежуточной валютой, которая ему не нужна?_

Группировка (batching) – это концепция объединения нескольких операций в одной транзакции. Это гарантия того, что при выполнении ряда операций после отправки в сеть в случае сбоя одной операции все остальные операции в транзакции завершаются неудачно [80]. Например, если мы хотим обменять BTC на ETH, то при отсутствии возможности совершить обмен напрямую, можно сначала обменять, допустим, BTC на XLM, и только потом – XLM на ETH. В таком случае эти операции группируются, и если одна из них не будет выполнена, то и остальные будут отменены.

_– Есть ли у децентрализованных бирж внутренние токены или криптовалюты?_

На сегодня существует несколько бирж, которые используют свой внутренний токен для оплаты комиссионных сборов при проведении транзакций на своих платформах. Примерами платформ, использующих свой нативный токен внутри собственной экосистемы, являются такие биржи: Binance (Binance Coin), Bitfinex (UNUS SED LEO), Huobi (Huobi Token), OKEx (OKB), Kucoin (KuCoin shares), Exmo (EXMO Coin), BitMax (BitMax Token), Bibox (BibBox Token), FTX (FTX Token), Gate.io (GateChain Token).

_– Предположим, на некоторую биржу мы вносим некоторую сумму USDT одной учетной системы (Omni Layer), а затем выводим с нее соответствующую сумму USDT другой системы (Ethereum). Считается ли в таком случае активы взаимозаменяемыми (fungible)?_

По этой же схеме можно обменять у незнакомца на улице $100 на кирпич. Впрочем, после такого обмена взаимозаменяемыми доллар и кирпич не становятся, не так ли? Есть точка зрения, что цифровые активы нельзя считать полноценно взаимозаменяемыми, если они минимально отличимы друг от друга. Если хотя бы одна сторона обмена не соглашается обменивать актив A<sub>1</sub> на актив A<sub>2</sub>, минимально отличимый от A<sub>1</sub>, то взаимозаменяемости между этими активами фактически нет.


## 1.5 Децентрализованный аукцион

Аукцион – это специально организованный рынок продажи товаров, услуг или активов, в классическом варианте которого участники сами предлагают цену (делают ставки), за которую готовы купить товар, а покупателем (победителем) становится участник, сделавший наивысшую ставку. Таким образом, главная задача аукциона – не совершение сделок, а определение победителя и цены.

Изначально организация таких рынков заключалась в том, что продавцы и покупатели собирались вместе, осматривали товар и проводили аукцион по очереди для каждого товара. Надежность такой организации аукциона состоит в открытости действий участников, т. е. каждый видит (слышит) ставку каждого непосредственно и может убедиться в правильности определения победителя и цены (рис. 1.36).

![Рисунок 1.36 – Схема взаимодействия участников офлайн-аукциона](/resources/img/volume-3/1.5-Decentralized-auction/F-1.36-interaction-in-offline-auction.png "Рисунок 1.36 – Схема взаимодействия участников офлайн-аукциона")


### Принцип работы онлайн-аукциона

С распространением Интернета начали появляться и онлайн-аукционы. Такой подход организации имеет следующие преимущества: участвовать в аукционе можно удаленно, длительность аукциона может быть значительно большей, аукционы могут проходить параллельно для множества товаров.

Однако до 2015 года онлайн-аукционы создавались исключительно как централизованные решения. На таких площадках, по сути, кроме участников аукциона (продавцов и покупателей), необходим организатор. Роль организатора состоит в том, что он принимает ставки от участников и по завершении аукциона объявляет победителя (рис. 1.37). В этом случае организатор и есть центр принятия решений, который не предусматривает возможности аудита каждого запроса пользователя. Очевидный недостаток такой организации состоит в том, что участники не могут убедиться в правильности принятых организатором решений.

![Рисунок 1.37 – Схема взаимодействия участников централизованного онлайн-аукциона](/resources/img/volume-3/1.5-Decentralized-auction/F-1.37-interaction-in-centralized-online-auction.png "Рисунок 1.37 – Схема взаимодействия участников централизованного онлайн-аукциона")

Опишем наиболее простой сценарий поведения нарушителя. Допустим, Анатолий является организатором онлайн-аукциона, где скоро будет выставлен на продажу большой участок с хорошим кирпичным домом возле центрального парка. Об этом знает Тарас. Тарас также знает, что такой дом можно без труда продать за 100 тысяч монет. Поэтому до начала аукциона с домом Тарас приходит к Анатолию и просит его настроить свою онлайн-площадку так, чтобы она не принимала ставки выше 30 тысяч монет. Тарас предлагает Анатолию вознаграждение 10 тысяч монет, если он объявит Тараса победителем аукциона с возможностью купить участок с домом за 30 тысяч монет. В таком случае по окончании аукциона Тарас может купить участок с домом по заниженной цене, а продавец даже не будет знать о том, что были желающие заплатить больше.

Несмотря на то, что организатор централизованного онлайн-аукциона не является посредником и не принимает участия в самой сделке, он может выбрать победителя на свое усмотрение и тем самым повлиять на цену товара. Поэтому централизованные онлайн-аукционы требуют доверия со стороны как продавцов, так и покупателей. Проблему доверия, а также проблему взаимодействия пользователей разных площадок можно решить с помощью децентрализованного подхода.


### Принцип работы децентрализованного онлайн-аукциона

Выполнение задачи обеспечения отказоустойчивости аукциона при приеме ставок от участников можно обеспечить за счет использования совместной базы данных, защищенной от модификаций. Например, если все участники будут публиковать данные о товаре и ставках в базу данных Bitcoin, то история их действий будет оставаться целостной и защищенной от модификаций, а поскольку база данных открыта, то каждый участник самостоятельно может вычислить победителя.

На первый взгляд может показаться, что этого достаточно для нормального функционирования аукциона и уже можно обойтись без роли организатора. Но на практике такой способ работать не будет, т. к. он не защищен от участников, которые не собираются покупать товар, а лишь завышают цену фальшивыми ставками.

Далее давайте рассмотрим один из подходов к организации децентрализованного онлайн-аукциона, который успешно применяется на практике [48]. Он подразумевает, что существует большое количество независимых площадок, где продавец может зарегистрироваться и создать лот на продажу товара, а покупатель может зарегистрироваться, доказать свою платежеспособность и делать ставки. Как правило, у разных площадок разные владельцы, разные приложения и интерфейсы пользователя, разная локализация, разные методы доказательства платежеспособности, разные наборы поддерживаемых категорий товаров и т. п. Однако все эти площадки поддерживают единый протокол совместного учета лотов и ставок. Они являются фактическими узлами-валидаторами децентрализованной учетной системы, куда сами же и записывают действия своих пользователей. В этом случае лот, созданный пользователем одной площадки, будет доступен и пользователям всех остальных площадок, как и ставка, сделанная пользователем одной площадки, будет сохранена всеми площадками и видна всем пользователям (рис. 1.38).

![Рисунок 1.38 – Схема взаимодействия участников децентрализованного онлайн-аукциона](/resources/img/volume-3/1.5-Decentralized-auction/F-1.38-interaction-in-decentralized-online-auction.png "Рисунок 1.38 – Схема взаимодействия участников децентрализованного онлайн-аукциона")

Этот подход использует в качестве механизма достижения консенсуса алгоритм на основе BFT, где вес каждого валидатора (площадки) пропорционален количеству его пользователей. Таким образом, чем более качественный сервис предоставляет площадка, тем больше у нее будет пользователей и тем большим будет ее вес в достижении консенсуса по аналогии с механизмами достижения консенсуса на основе proof-of-stake. Если пользователи замечают, что владелец их площадки неправильно обрабатывает их запросы или отказывает в обслуживании, то они переходят на другую площадку, тем самым уменьшая вес «плохих» площадок и увеличивая вес «хороших».

Для защиты системы от фиктивных пользователей и фальшивых ставок используются цифровые квитанции, заверенные банком. При регистрации на площадке пользователь предоставляет квитанцию, заверенную цифровой подписью своего банка, которая подтверждает его платежеспособность. Все площадки публикуют такие квитанции в совместную базу данных для подтверждения количества своих пользователей и соответствующих платежей по лотам.

С точки зрения простоты использования децентрализованного аукциона, построенного по такому подходу, он сравним с централизованным решением – приложением с обычным аккаунтом. А с точки зрения возможностей и надежности – имеет преимущества: лоты и ставки синхронизируются между всеми площадками и вероятность сговора минимизирована.

Еще одна отличительная особенность данного подхода состоит в том, что владельцы уже давно существующих централизованных платформ онлайн-аукционов могут относительно легко перейти на новую платформу. Для этого не нужно строить всю инфраструктуру с нуля или переводить пользователей на новые непривычные приложения, достаточно в существующую инфраструктуру интегрировать узел децентрализованной сети (network node), а для начала синхронизации владельцы площадок должны обменяться сетевыми адресами и открытыми ключами.


### \*\*\*Распространенные мифы\*\*\*

_Децентрализованный аукцион гарантирует победителю получение соответствующего товара или услуги._

Децентрализованный аукцион может гарантировать только то, что любой желающий может самостоятельно провести аудит учетной системы и получить тот же результат, что и остальные честные аудиторы. По сути, результат работы аукциона – не выполненная сделка, а определенный победитель и цена. Далее победитель и продавец действуют самостоятельно и могут использовать результаты работы аукциона для защиты своих прав.

### \*\*\*Часто задаваемые вопросы\*\*\*

_– Как бороться с возможными перегрузками децентрализованной учетной системы, которая обрабатывает действия всех пользователей по всем лотам?_

Одновременно могут существовать несколько отдельных децентрализованных учетных систем, каждая из которых обрабатывает аукционы по отдельному типу товаров или услуг. При этом площадка может синхронизироваться с несколькими учетными системами одновременно, а ее пользователи даже могут не знать, что их действия фиксируются в разных системах. Это исключает существование одной перегруженной учетной системы и избавляет площадки от обработки данных о товарах, которые не интересуют ее пользователей. Например, площадка Алисы синхронизируется с учетными системами аукционов по торговле автомобилями, домашней мебелью и зимней одеждой, а площадка Боба синхронизируется с учетными системами аукционов по торговле автомобилями, компьютерами и домашними животными.

_– Любой ли пользователь может выставить лот на торговую площадку?_

Да. Как правило, все цифровые аукционы расположены на цифровых биржах и каждый участник идентифицируем для участия в аукционах. Однако прежде чем выставить лот, необходимо подтвердить его наличие. Это может быть реализовано с помощью цифровых сертификатов, выданных стороной, которой доверяет та или иная биржа, на чьей платформе находится торговая площадка и проводится аукцион.

# [2 ПОДПИСИ ШНОРРА И СВЯЗАННЫЕ С НИМИ ОБНОВЛЕНИЯ](https://github.com/distributed-lab/blockchain-and-decentralized-systems-book/blob/main/chapters/volume-3/ru/2-Schnorr-signatures-and-their-application.md)
