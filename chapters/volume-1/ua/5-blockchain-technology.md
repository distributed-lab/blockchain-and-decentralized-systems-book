# 5 ТЕХНОЛОГІЯ BLOCKCHAIN


## 5.1 Технологія blockchain та її можливості

Про технологію *blockchain* поза контекстом криптовалют почали активно говорити у 2014 році. У той час люди почали усвідомлювати, що децентралізований підхід, що використовується в Bitcoin, можна застосувати в інших галузях, і що технологія blockchain є ключовою. Наприклад, використання цієї технології в облікових системах може захистити дані від несанкціонованих модификацій. Забезпечення в системах властивостей, як-от *незмінюваність, цілісність, trustlessness, надійне узгодження* тощо, отримало широкий відгук у суспільстві.

До появи Bitcoin усі фінансові системі були закритими та захищеними «традиційними» методами: міжмережевими екранами (фаєрволи, брандмауери), системами управління доступом й адміністраторами безпеки. Дуже небагато організацій підтримувало відкритий API чи дозволяли створювати розширення чи альтернативні застосунки стороннім розробникам. Bitcoin уперше показав, що фінансова система може не тільки не мати центру прийняття рішень, але також бути прозорою для *всіх*, доступною для проведення аудиту та водночас може забезпечувати більш високий рівень приватності користувачів.

*Технологія blockchain дозволила організувати зберігання та синхронізацію даних серед сторін, що не довіряють одна одній*. Замість того, щоби покладатися на довірені сторони та комунікації для досягнення цілісності бази даних, технологія blockchain передбачає, що всі дані про транзакції (чи інші записи) згруповані в блоки, кожний із яких криптографічно пов’язаний із попереднім.

> **_Зауваження._** *Відсутність довіри між учасниками облікової системи на основі blockchain не обов’язкова. Ви можете довіряти певним учасникам. Але головна перевага blockchain якраз полягає в тому, що навіть тоді, коли довіряти ні́кому, ви можете повноцінно працювати із системою.*

Коли використовують слово блокчейн у повсякденному мовленні, можуть мати на увазі зовсім різні речі. Тому потрібно зауважувати та розуміти цю різницю. Ми розглянемо три значення з тих, що найчастіше трапляються. Словом blockchain можна описати базу даних конкретної облікової системи (наприклад Bitcoin). Друге можливе значення – окрема реалізація технології. Третій (і найбільш правильний) варіант уживання терміна – позначення способу організації даних загалом. Тому слід обережно використовувати цей термін, зважаючи на контекст.

Насправді результат численних дискусій про корисність blockchain можна помістити в одну фразу: на відміну від традиційних облікових систем, у яких користувачі змушені осліп довіряти наданим даним (незалежно від того, чи добуто дані всередині системи чи поза її межами), в облікових системах на основі технології blockchain є можливість перевірити цілісність і хронологічну впорядкованість даних. Унаслідок цього учасники можуть більшою мірою покладатися на ці дані (причому як звичайні користувачі, так і володільці системи).

> **_Зауваження._** *Фразу «більшою мірою покладатися» слід розуміти як можливість незалежно зберігати та верифікувати цілісність і впорядкованість даних, покладаючись на деякі зовнішні дані, як-от сертифікати відкритих ключів, сторонні криптографічні бібліотеки тощо. Це також має на увазі наявність жорстко заданих правил, згідно з якими можна математично перевірити коректність транзакції, побудованої на їхній основі.*
> *Blockchain – це не панацея, що робить усі дані всередині системи достовірними.*

### Ступені децентралізації

Ступінь децентралізації певної системи не завжди просто виміряти. Кінцевою метою будь-якої облікової системи є не власне децентралізація, а, імовірніше, досягнення деякої комбінації властивостей, як-от конфіденційність, цілісність, стійкість, надійність і продуктивність. Децентралізація вигідна настільки, наскільки вона дозволяє досягти цих властивостей. Наприклад, якщо система повністю анонімна, то в ній значно простіше забезпечити стійкість до цензури, перевірку даних без довіри до третьої сторони й економічне стимулювання для розподілення прийняття рішень.

Якщо ми спробуємо побудувати лінійну шкалу можливих ступенів децентралізації системи, вона може мати такий вигляд, як на рис. 5.1.

![Рисунок 5.1 – Можливі ступені децентралізації системи](/resources/img/volume-1/5.1-blockchain-technology-and-its-capabilities/5.1-degree-of-decentalization.jpg)

Усі ці випадки можливо оцінити та в подальшому порівняти за такими критеріями: кількість валідаторів, їхня анонімність, необхідність наявності у валідаторів репутації та необхідність розголошення репутації валідаторів решті учасників системи.

*Реєстр цифрової власності (digital ownership ledger)*. З лівого боку шкали розташована система, у якій є один власник, що управляє всіма бізнес-активами. У такій системі досягнення консенсусу не потрібне та необхідність довіри користувачів до володільця системи найбільше виражена. Такий підхід можливо описати як застосування технології blockchain у централізованому середовищі (такий підхід має свої переваги, про які ми поговоримо в 6.4).

Якщо є два партнери, що спільно управляють обліковим записом компанії та не довіряють один одному щодо здійснення платежів, авторизації транзакцій і ведення обліку транзакцій, ситуація кардинально відрізнятиметься. Вони обидва повинні підписувати кожну транзакцію та зберігати інформацію про неї в локальних копіях бази даних. Технологія blockchain допомагає автоматизувати цей процес. Найпростіший спосіб досягнення консенсусу тут – використовувати мультипідпис (кожну транзакцію завіряти двома підписами). Вимога анонімності відсутня, позаяк партнери мають бачити транзакції, які вони підписують. Транзакції може бути узгоджено дуже швидко; проблем із їхньою послідовністю також немає, тому що кожна з них містить часову позначку. У захисті від цензури немає сенсу. У якийсь спосіб мотивувати партнерів підтримувати вузол не потрібно.

*Взаєморозрахунок (reconciliation)*. Цей випадок детально буде розглянуто нижче. Його ключова особливість порівняно з попереднім випадком – більша кількість учасників, між якими має бути досягнуто консенсус, і вона може досягати декількох десятків (здебільшого їхня кількість обмежена та відома завчасно). Тут система має більш децентралізований характер, а підходу з використанням мультипідпису вже не достатньо для досягнення консенсусу. У таких ситуаціях і знаходять застосування алгоритми досягнення консенсусу, як-от BFT, FBA, PoI, PoA (докладніше в 5.2).

*Платформа токенізації (tokenization platform)*. У таких системах можна досягти більш високого рівня децентралізації, а кількість сторін, що беруть участь у досягненні консенсусу, може змінюватися й не обмежується. Для досягнення консенсусу часто використовують алгоритм FBA.

*Платформа голосування (voting platform)*. Публічне голосування має на увазі, що всі його учасники повинні досягти консенсусу та мати можливість підтвердити результати виборів. Утім, усім учасникам необхідно пройти ідентифікацію, унаслідок якої їхні особи може бути підтверджено (навіть якщо учасники безпосередньо не знайомі один з одним і не можуть один одному довіряти). Алгоритм досягнення консенсусу FBA також добре підходить для таких систем.

*Криптовалюта (cryptocurrency)*. Протокол першої криптовалюти (Bitcoin) заздалегідь передбачав, що кількість учасників не визначена, усі вони анонімні та не мають репутації. Для роботи в таких умовах було вибрано один підхід до досягнення консенсусу – proof-of-work. У цьому разі пропускна здатність системи сильно обмежена порівняно з системами, які ми описували раніше. Крім того, у таких системах необхідний економічний механізм для мотивування учасників системи діяти за правилами протоколу й гарантування того, що мережа не втратить децентралізований характер із плином часу. Це зумовлює потребу мати в системі внутрішню валюту з відповідними властивостями.

Є декілька проблем, притаманних архітектурі Bitcoin. По-перше, транзакції може бути відстежено (цю проблему частково вирішено в криптовалютах ZCash і Monero). По-друге, є деяка концентрація обчислювальних потужностей серед невеликої кількості майнінгових пулів.

*? – нові криптовалюти (ще не винайдені)*. Остання крапка на шкалі вказує на системи, у яких рівень децентралізації та приватності найвищий. За властивостями такі системи ідеальні і трапляються тільки в теорії, але ми можемо сформувати низку вимог до них, що дозволять створити нові, наближені до таких систем моделі. Передусім, це **повна** конфіденційність транзакцій (щось на кшталт ZCash, проте без механізму trusted setup). Це означає, що сторонній спостерігач не може побачити факт здійснення транзакції, не кажучи про її вміст. Такі криптовалюти повинні підтримувати повністю децентралізований майнінг без жодних стимулів для створення пулів (аналогічно до того, що дозволяє DAG, але за відсутності централізованого координатора). Окрім того, користувачі такої мережі можуть спілкуватися цілковито в спосіб p2p, використовуючи підхід mesh-мереж замість централізованого інтернет-провайдера, який перебуває на шляху між користувачем і децентралізованою системою.

У підсумку, будь-яка система, у якій необхідна згода між визначеною (такою, що повільно змінюється) кількістю учасників, використовуватиме різновиди алгоритму BFT; приклад – будь-яке голосування, від ради директорів до загальнонаціонального. Авжеж, їй не потрібна власна валюта. Питання цензури буде вирішено не технічною можливістю її запобігання, а негайним розголошенням самого факту (завдяки тому, що «всі знають усе»).

Залежно від того, які завдання вирішуватиме облікова система, її база даних матиме цілком різні властивості. У спільноті використовують декілька термінів для визначення її типу за рівнем доступності.

*Permissionless*. Будь-хто може взяти участь у певному процесі без жодних обмежень і дозволів. Якщо деяка система заявляє, що вона permissionless, це значить тільки те, що абсолютно всі процеси, які виконують у системі, доступні будь-кому охочому. Іноді ці системи називають *public blockchains*.

*Permissioned*. Ця властивість передбачає, що для участі щонайменше в одному певному процесі потрібний окремий дозвіл. Іноді ці системи називають *private blockchains*.

### Архітектура blockchain

У ланцюжку блоків кожний наступний блок містить геш-значення від попереднього (рис. 5.2). Усі спроби змінити дані, записані на певному рівні, спричиняють зміни на всіх наступних рівнях, та їх помітить решта учасників системи. Так забезпечена перевірка цілісності бази даних (database integrity verification).

![Рисунок 5.2 – Зв’язок між блоками в ланцюжку](/resources/img/volume-1/5.1-blockchain-technology-and-its-capabilities/5.2-link-between-blocks.png)

У такий спосіб формується послідовність блоків – ланцюжок (звідки й пішла назва blockchain), де кожний наступний блок містить геш-значення від попереднього. Для зв’язування блоків має бути використано стійку геш-функцію. Якщо внести зміни до попередніх блоків, то всі наступні стануть некоректними, тобто їх доведеться перестворити. Ця особливість унеможливлює змінювання історії заднім числом непомітно для решти учасників.

### Властивості блокчейна

Теоретично технологію блокчейн можна застосувати для організації даних у будь-якій СУБД. Ланцюжок блоків може бути організовано абстрактно; програмне забезпечення не обов’язково зберігатиме дані транзакцій в організованих блоках: достатньо, щоби заголовок задовольняв відповідному формату. Отже, вузол мережі може організувати зберігання й оброблення транзакцій у будь-який зручний спосіб, а для синхронізації з іншими вузлами дані серіалізують у блоки визначеного формату та передають мережею.

> **Властивості облікової системи, які можуть бути забезпечені за допомогою технології blockchain**
>> * *Цілісність історії зміни бази даних* 
>> * *Мінімізація затримок синхронізації та резервного копіювання* 
>> * *Можливість одночасної роботи групи валідаторів* 
>> * *Можливість здійснення аудиту в режимі реального часу* 
>> * *Можливість використання легких клієнтів і SPV-вузлів* 
>> * *Timestamping (anchoring, фіксація даних із прив’язанням до часу)*
>> * *Trustlessness (необхідний рівень довіри користувача мінімальний)*

Особливості реалізації властивостей блокчейна для різних середовищ показано в таблиці 5.1.

![Таблиця 5.1 – Властивості, що може надати blockchain](/resources/img/volume-1/5.1-blockchain-technology-and-its-capabilities/table-5.1.png)

Коли ступінь децентралізації облікової системи підвищується, тобто збільшується кількість валідаторів, з’являється потреба в механізмі досягнення консенсусу щодо правильного стану системи.

Володілець повного вузла може впевнитися в коректності стану історії всіх транзакцій, завдяки чому робота в обліковій системі прозора для аудитора. Якщо хтось із користувачів навмисно складе некоректну транзакцію та відправить її до мережі, усі чесні учасники відразу це помітять і відкинуть її. А якщо зловмисний валідатор створить блок із некоректною транзакцією, то всі чесні учасники це теж помітять і відкинуть увесь блок цілком.

Якщо транзакцію, яку вже було прийнято в обліковій системі, пізніше скасовують валідатори, то користувач матиме неспростовний доказ того, що його ошукали. Адже відповідний блок містить доказ (цифровий підпис або PoW) того, що валідатори раніше віддали свій голос за цю транзакцію. Таким чином, користувач має можливість довести, що в обліковій системі трапилося шахрайство з боку валідаторів, якщо вони, наприклад, перепишуть історію декількох останніх блоків.

Якщо мова йде про систему обліку, яку контролює одна організація, і з якихось причин ланцюжок блоків було переписано, то в цифровому гаманці користувача залишаються докази, а саме транзакції, завірені цифровим підписом організації.

Тому питання довіри між партнерами в обліковій системі з застосуванням блокчейна не надто актуальне. Надійність її роботи можуть забезпечити правила протоколу.

Користувач має можливість установити легкий клієнтський застосунок, де буде відображено поточний стан бази даних, не запускаючи повний вузол. Ця властивість важлива для permissionless системи за умови, що користувач покладається на те, що система працює надійно (у Bitcoin це значить, що більшість обчислювальної потужності належить чесним користувачам).

Коли облікова система досягає достатнього рівня децентралізації та незмінюваності записів, великого значення набуває часова мітка. Вона дозволяє зафіксувати факт знання певних даних у певний момент часу та, що найбільш важливе, згодом довести цей факт будь-кому. У результаті, користувачі можуть бути впевнені, що зміни стану бази даних із високою ймовірністю відповідають послідовності, у якій ці зміни було ініційовано.

### Застосування технології блокчейн

Теперь обговоримо, у яких ситуаціях варто застосовувати блокчейн. Адже ця технологія дозволяє спроєктувати надійну систему, де людський чинник зведено до мінімуму. Розгляньмо п’ять найбільш доречних і багатообіцяльних галузей застосування технології blockchain.

> * *Електронне голосування* 
> * *Ланцюжки постачань* 
> * *Децентралізована торгівля* 
> * *Публічні реєстри* 
> * *Взаєморозрахунки*

*Електронне голосування*. Кожний голосувач може бути впевненим, що його голос буде враховано. За цього складно отримати право голосу двічі та складно вкрасти чужий голос. Усі транзакції в мережі можуть бути конфіденційними, що зменшує ймовірність встановити особу голосувача. Упродовж голосування будь-хто охочий може перевірити коректність усіх транзакцій із голосами, щоб упевнитися, що всіх їх урахують (рис. 5.3).

![Рисунок 5.3 – Електронне голосування](/resources/img/volume-1/5.1-blockchain-technology-and-its-capabilities/5.3-evoting.png)

Голосувач повинен мати можливість довести, що він має право голосу. Водночас потрібно зробити так, щоби він міг скористатися їм тільки один раз. Найімовірніше, це вказує на необхідність створення центрів сертифікації, де голосувачі реєструватимуть свої відкриті ключі. Ці пункти мають перебувати під керівництвом однієї організації, яка перевірятиме, що одна людина не зареєструвала декілька ключів. Тому довіра переходить від виборчих органів до центрів сертифікації, які, зі свого боку, також мають бути перевірені. Digital identities у деяких державах, передусім в Естонії, частково вирішують цю проблему.

Потрібно вибрати такий алгоритм досягнення консенсусу, який дозволяє кожному учаснику провести підрахунок голосів і зіставити свої результати із результатами інших учасників. Для цього можна застосувати алгоритми PoS, FBA, BFT (докладніше в 5.2).

Розповсюдження програмного забезпечення для голосування й аудиту – також велика проблема. Загрози трапляються на всіх етапах (від розробки до встановлення та виконання).

Таким чином, унаслідок застосування блокчейна система електронного голосування отримує дуже гарні властивості. Однак є низка завдань, які необхідно вирішити для реалізації цього проєкту.

*Ланцюжки постачань*. Від виробника до споживача товар проходить крізь коридор посередників – так званий ланцюжок постачань (supply chain). Однак наявність логотипа виробника на товарі ще не значить, що сам товар оригінальний. На шляху прямування продукту є багато ризиків, зокрема ризик підміни.

Упровадження блокчейна в системи обліку ланцюжків постачань може вбезпечити товари (точніше, дані про їх стан, розташування тощо) на шляху їх прямування. Тоді покупець може отримати вичерпні дані про стан товару. Проте вносити ці дані до бази можуть тільки певні посадові особи, відповідальні за виробництво, збирання, завантаження на корабель, перевезення до наступного пункту тощо.

Якщо зловмисник захоче підробити транзакції, уже додані до ланцюжку блоків, то йому буде потрібно примусити валідаторів змовитися чи зламати відразу декілька різних серверів, на яких запущено ці вузли-валідатори. Крім того, використання надійних механізмів синхронізації даних між учасниками ланцюжка дозволяє запобігти появі невідповідностей у їхніх облікових системах. Такий підхід надасть певні гарантії покупцю та зробить систему управління ланцюжками постачань безпечнішою. Пригожі для цього завдання алгоритми – FBA та BFT.

У підсумку, саме споживач може просигналізувати в разі виявлення підробки. Маючи систему управління постачаннями, побудовану з застосуванням технології blockchain, доволі легко перевірити, який саме продукт має бути доставлено та надалі продано через конкретний магазин. Якщо споживач купує упаковку пігулок у Римі, а система перевіряння (яку він використовує, наприклад, через сканування штрихкоду в мобільному застосунку) повідомляє, що упаковку було доставлено до Парижа, це зумовить явні сумніви в чесності імпортера. Можна також зробити висновок, що товар, доставлений до Парижа, підроблений (якщо штрихкоди унікальні).

*Децентралізована торгівля*. Із застосуванням технології блокчейн і децентралізованого підходу можливо здійснювати аукціони на багатьох дрібних торговельних майданчиках. Товар, який виставляють на продаж на одному з майданчиків, буде доступним і на всіх інших (рис. 5.4). Таким чином, у продавця з’являється можливість надати товар максимально великій і зацікавленій аудиторії покупців.

![Рисунок 5.4 – Приклад децентралізованого аукціону](/resources/img/volume-1/5.1-blockchain-technology-and-its-capabilities/5.4-auction.png)

Оскільки немає необхідності дублювання товару на кожному майданчику, продавець зберігає багато часу. Навіть більше, торги ведуть на них одночасно, а дані про ставки синхронізують у режимі реального часу. Тому кожний майданчик завжди знає всі ставки за кожним лотом, відповідно, переможець для всіх очевидний.

Людський чинник у такій системі зведено до мінімуму – провести аудит у такій системі не складно та не витратно за часом. Дані про всю історію угод неможливо змінити непомітно. Пригожі алгоритми досягнення консенсусу для цього завдання – PoW, PoS, FBA та BFT; вибір конкретного з них залежить від вимог до анонімності та стійкості до цензури.

*Публічні реєстри*. Публічний реєстр доступний усім за визначенням. Якщо таким реєстром керує одна організація, то до нього може бути внесено будь-які зміни, зокрема заднім числом. Довіряти цим даним можливо рівно настільки, наскільки ви довіряєте цій організації.

Основна причина, з якої публічними реєстрами управляють державні органи, полягає в тому, що користувачі не бажають, щоб управління blackbox-системою (система, у якій користувачу відомі тільки вхідні та вихідні дані, а всі процеси, що відбуваються в ній, невідомі) здійснювали комерційні організації. Реєстр, створений із застосуванням блокчейна, може вирішити проблему довіри через децентралізацію бази даних і процесу синхронізації, не дозволяючи якій-небудь окремій організації вносити приховані зміни до системи. Копію бази даних може вести декілька організацій або велика публіка (рис. 5.5). Отже, цензурування від одної лише сторони стає неможливим: є багато володільців реєстрів, які перевіряють усі зміни.

Тому ведення державних реєстрів можливо передати недержавним організаціям, що зумовлює зменшення витрат та підвищення впевненості громадян у цілісності реєстру. Найбільш пригожий алгоритм досягнення консенсусу для цього завдання – FBA.

![Рисунок 5.5 – Децентралізоване ведення реєстрів](/resources/img/volume-1/5.1-blockchain-technology-and-its-capabilities/5.5-registry.png)

*Взаєморозрахунки*. Уявімо, що 10 банків хочуть організувати партнерство для того, щоби надавати своїм користувачам послуги швидше та дешевше. Їм потрібно створити спільну платіжну систему, щоб організувати безпосередні розрахунки з підприємствами та приватними особами, з якими вони працюють. Тому вони можуть розробити приватну облікову систему з застосуванням блокчейна, у яку вони вноситимуть усі необхідні дані та в якій вони зможуть здійснювати взаєморозрахунки.

Кожний банк зможе підтримувати свій вузол мережі та перевіряти всю історію транзакцій. Оскільки кожний банк має власні інтереси, змова в системі малоймовірна (значно менш імовірна, ніж у системах, у яких розрахунками займається одна організація). До того ж, така облікова система дозволить зробити розрахунки дешевшими та безпечнішими переважно тому, що банкам-учасникам не потрібно буде платити стороннім організаціям за проведення розрахунків. Історія транзакцій зберігається в ланцюжку блоків, яким керують декілька незалежних компаній; це значно ускладнює атаки на систему. Окрім того, доволі просто провести надійний автоматизований аудит порівняно з традиційними системами. Пригожі алгоритми досягнення консенсусу тут – FBA та BFT.

### Підсумки

З наведених вище варіантів застосування технології видно, що облікова система, у якій застосовують блокчейн, має низку переваг:

* Простота перевіряння цілісності бази даних 
* Timestamping усіх змін (наявність у кожної зміни своєї часової мітки)
* Просте резервне копіювання в режимі реального часу 
* Безпечна синхронізація даних у децентралізованому середовищі
* Простий аудит системи в реальному часі

Технологія блокчейн може забезпечити надійне зберігання даних і наділити облікову систему низкою цінних властивостей. Проте складність проєктування, налаштування та підтримування децентралізованої облікової системи зазвичай набагато вища, аніж для централізованих альтернатив, тому необхідно усвідомлено підходити до цього питання.

Слід мати на увазі те, що ці переваги не завжди гарантовані на 100 %. Блокчейн – не срібна пуля: успіх функціонування тієї чи іншої системи безпосередньо зумовлюють правила її протоколу та спосіб її реалізування, а не лише факт, що в ній використовується технологія blockchain.

**Поширені міфи**

*Блокчейн може перевіряти будь-які дані, які в ньому зберігають.*

Формулювання цього міфу містить помилки, а також для декого зазначене в ньому навіть здається правильним за замовчуванням. Траплялося так, що люди хотіли замовити систему обліку з застосуванням технології blockchain, яка повинна була перевіряти та записувати їх біржевий індекс. На питання про те, навіщо їм був потрібним блокчейн, вони відповідали просто: «Щоби нашим даним вірили».

Коли йде формування нового блока, валідатори можуть орієнтуватися тільки на дані про попередні блоки та одне лише, на що вони спираються, – правила протоколу, за якими перевіряють коректність транзакцій. Неможливо перевірити справжність і коректність даних, які хтось записує до блокчейна. Валідатори можуть упевнитися тільки в тому, що дані, записані до блокчейна, не було змінено в конкретний момент часу в минулому.

*Блокчейн повільний і потребує багато енергії*

Облікова система, яка використовує технологію blockchain, може застосовувати такий механізм досягнення консенсусу, що забезпечує високу пропускну здатність, за якої транзакції отримують повне підтвердження впродовж декількох секунд. Цей механізм досягнення консенсусу не обов’язково буде вимогливим до обчислювальних ресурсів валідаторів. Саме завдяки правильному проєктуванню механізму досягнення консенсусу можна побудувати за допомогою технології blockchain облікову систему, яка матиме потрібні характеристики (у нашому випадку характеристики пропускної здатності).

*Блокчейн гарантує надійність і прозорість даних.*

Історію транзакцій дійсно змінити неможливо, але щоби змінити стан актуальних даних, не обов’язково змінювати наявні блоки та їхні зв’язки. Досить створити альтернативний ланцюжок і домогтися того, щоби він став основним. Це цілком залежить від згоди сторін, які досягають консенсусу.

Уявімо, що п’ять банків вирішили створити систему взаємодії з застосуванням блокчейна. Щоби здійснювати платежі, їм потрібно домовитися. Для цього вони встановлюють правила, за якими вони досягатимуть згоди. Це має сенс тільки в тому випадку, коли кожний із них діє згідно зі своїми інтересами. Якщо ж вони змовляться, то зможуть переписати ланцюжок блоків будь-як, лише замінивши його альтернативним. Таким чином, факт застосування блокчейна, насправді, не гарантує прозорість і надійність системі обліку для стороннього спостерігача. Однак аудитори, які мають доступ до історії транзакцій, і навіть клієнти помітять атаку та зможуть беззаперечно довести факт того, що вона відбулася.

*Блокчейн у Bitcoin зашифрований.*

Незважаючи на помилку у формулюванні, думка про те, що спільна база даних зашифрована, дійсно поширена. Дехто навіть стверджує, що біткоїни – це зашифровані гроші. Авжеж, це не так. Власне технологію блокчейн можливо застосувати для організації будь-яких даних, зокрема зашифрованих. Проте якщо їх використовують для прозорого обліку монет, то дані повинні бути у відкритій формі, щоби будь-хто охочий міг упевнитися в їхній коректності. Слід також відзначити, що деякі розширення, як-от механізм confidential transactions, дозволяють зробити певні дані транзакцій приватними (див. 7.2).

*Блокчейн замінить сервери..*

Така думка часто трапляється серед людей, які не мають уявлення про способи організації великих обсягів даних і взагалі про інформаційні технології. Навіть якщо деяку бізнес-логіку реалізують вузли блокчейна (наприклад, виконання смарт-контрактів), самі вузли будуть серверами. Твердження, що сервери більше не потрібні, також було популярним під час буму хмарних обчислень. Слід розуміти, що сервери нікуди не зникли, а лише змінили своє розташування (Amazon, IBM, Google).

*Блокчейн замінить нотаріусів.*

Цей міф стосується не тільки нотаріусів, а й будь-яких посередників. Це не правда. Якщо ваша облікова система має справу з якимись даних даними з зовнішнього світу, блокчейн не виключить тих, хто перевіряв би їх і реєстрував у базі даних.

Уявімо, що Аліса продає свій дім Бобу. Технологія blockchain може оптимізувати цей процес, але не може замінити посередників, як-от нотаріусів. Валідатори не можуть дізнатися, чи Аліса дійсно використала свій ключ для продажу дому, чи Боб – справжня людина, чи Аліса продає дім за власним бажанням тощо.

Технологія blockchain дозволяє валідаторам упевнитися тільки в тому, що математика збігається, але вона ніколи не відповідальна за те, що відбувається за межами облікової системи. Сторони, які передають дані ззовні до облікової системи, називають оракулами (докладніше в 6.3).

**Часті запитання**

*– Чи потрібна стандартизація blockchain як технології?*

У контексті протоколів децентралізованих облікових систем стандартизація може не дати бажаного результату, оскільки кожний із них спроєктовано по-своєму. Для вирішення же проблем, загальних для багатьох систем, стандартизація знадобиться. Наприклад, порядок генерування, зберігання та резервування ключів.

*– Чи є такі модифікації технології blockchain, у яких користувачі мають різні рівні доступу?*

Було би дійсно зручно, якби, наприклад, нотаріуси мали доступ до всіх даних і могли укладали угоди, а решта користувачів мала доступ тільки до тих даних, які стосуються безпосередньо їх. Проте технологія blockchain визначає тільки спосіб організації даних і не причетна безпосередньо до управління рівнями доступу до цих даних. Очевидно, що за використання комбінації різних підходів можна створити комплексне рішення для цього завдання (опис такого рішення – не мета цієї книги).

*– Як поява технології blockchain вплинула на світову фінансову галузь*

Ця технологія підштовхнула людей до створення нових систем, де забезпечуються властивості, як-от прозорість (аудит у реальному часі), відмовостійкість, нескасовуваність дій і відповідних записів. Крім того, такими системами може володіти й управляти не одна сторона, як це було з використанням традиційних технологій, а група незалежних сторін. До появи технології blockchain люди просто не вірили, що можливо одночасно та доволі просто досягти всіх перелічених вище властивостей.

У підсумку, багато компаній тестує та застосовує технологию блокчейн зокрема для здійснення обліку фінансів.

## 5.2 Відмінності підходів до досягнення консенсусу

Можна впевнено сказати, що механізм досягнення консенсусу – наріжний камінь будь-якої децентралізованої системи. Без розуміння принципів роботи цих механізмів неможливо спроєктувати безпечну й ефективну систему. Іноді порівнюють різні децентралізовані облікові системи за критерієм продуктивності, навіть якщо вони використовують різні механізми досягнення консенсусу. Однак якщо ці механізми принципово відрізняються, то й самі облікові системи відрізняються за багатьма критеріями, як-от надійністю, рівнем безпеки, ефективністю використання ресурсів, продуктивністю й обмеженнями. Це, зі свого боку, сильно впливає на галузь застосування систем. Тому варто з’ясувати, які характеристики найважливіші для типових децентралізованих облікових систем і як вони можуть залежати від підходу до досягнення консенсусу.

### Механізм досягнення консенсусу як ключовий елемент децентралізованої системи обліку

*Консенсус – це стан згоди між учасниками системи щодо деякого твердження чи пропозиції*.

*Алгоритм досягнення консенсусу – це звід правил і критеріїв, за якими учасники системи досягають згоди. Алгоритм досягнення консенсусу часто називають механізмом (або протоколом) досягнення консенсусу*.

Є багато підходів до досягнення консенсусу. Найвідоміші серед них – proof-of-work (PoW) та proof-of-stake (PoS). Освічені люди дуже рідко сперечаються між собою про те, який із підходів кращий, тому що це лише підходи, що не мають кількісних характеристик, а не конкретні реалізації облікових систем. Для кожного з них характерні свої переваги та недоліки; немає добрих або поганих підходів: є конкретні вимоги та допущення. Безсумнівно, для конкретного випадку використання один із них може виявитися пригожішим, або навіть «найкращим».

Раніше (див. 5.1) ми коротко згадали деякі механізми досягнення консенсусу для різних випадків використання. Імовірно, ідея використання мультипідпису (multisignature) для досягнення консенсусу між валідаторами облікової системи найпростіша. Такий алгоритм застосовують переважно для досягнення консенсусу всередині обмеженого кола осіб. Його застосування має сенс, коли всі учасники процесу знають один одного та склад учасників рідко зазнає змін. Чудовий приклад – голосування мешканців будинку щодо ремонту (рис. 5.6).

![Рисунок 5.6 – Досягнення консенсусу щодо ремонту будинку](/resources/img/volume-1/5.2-difference-in-consensus-approaches/5.6-house-repairs.png)

### Proof-of-work

Досягнення консенсусу на основі PoW стало популярним завдяки криптовалютам (докладніше про PoW в Bitcoin у 4.2). Цей алгоритм найпростіший за будовою та водночас найнадійніший в умовах повної децентралізації й анонімності. Однак часто принцип роботи PoW складно пояснити непідготовленій людині. Спробуймо навести просту аналогію.

Уявімо, що мешканці багатоквартирного будинку захотіли пофарбувати паркан у дворі. Щоби визначити, у який колір його фарбувати, мешканці проводят конкурс. Правила такі: кожний із них купує трамвайні квитки в кіоску неподалік; той, хто матиме квиток із найменшим номером, вирішить, якого кольору буде паркан. Припустімо, білети продаються у випадковому порядку. Очевидно, що володілець найбільшої кількості квитків має *пропорційно більшу ймовірність* стати саме тим щасливчиком.

Якщо наслідки прийнятих рішень дійсно важливі (тобто для мешканців будинку важливе, у який колір буде пофарбовано паркан у дворі), це мотивує кожного з мешканців купувати дедалі більше квитків. Виходить своєрідна «гонка озброєнь». Точно так само відбувається нарощування обчислювальної потужності серед учасників системи Біткоін. Якщо же є підозри, що хтось із мешканців змовився з продавцем, щоби той видав «виграшні» квитки, то частина мешканців може відділитися та побудувати новий дім, де вони прийматимуть рішення за іншими правилами.

### Proof-of-stake

Ідея PoS схожа на голосування акціонерів компанії: той, чия доля в компанії більша, має більшу вагу голосу за прийняття остаточного рішення. Таким чином, рішення в системі буде зумовлено не так кількістю голосів, як їхньою вагою (рис. 5.7).

![Рисунок 5.7 – Схема функціонування PoS](/resources/img/volume-1/5.2-difference-in-consensus-approaches/5.7-pos.png)

Конкретне порогове значення сумарної ваги для різних компаній може відрізнятися, і її заздалегідь визначають акціонери. В обліковій системі вона залежить виключно від правил конкретного протоколу: десь достатньо простої більшості (тобто 51%), десь потрібно дві третини (66%), а може бути таке, що для прийняття певного рішення потрібно 90% голосів за нього.

Період формування блока за допомогою PoS може бути значно меншим, ніж за допомогою PoW. Проте спроєктувати достатньо надійний алгоритм досягнення консенсусу на основі PoS для децентралізованої облікової системи, де будь-хто може стати валідатором, дуже складно.

### Delegated proof-of-stake

Це альтернативний до згаданих вище ідей досягнення консенсусу спосіб. Основна ідея delegated proof-of-stake (DPoS) – вибір делегатів, які братимуть участь у прийнятті рішень. Зазвичай особи користувачів-делегатів відомі завчасно. Часто це люди, відомі своїми досягненнями у певній галузі. У системі в них є облікові записи, асоційовані з їхніми особами. Делегатів вибирають самі користувачі.

Відзначмо, що вага голосу залежить від кількості монет на балансі користувачів тільки на етапі вибирання делегату. Самі же делегати голосують на рівних умовах, тобто результат голосування вирішується простою більшістю делегатів (валідаторів). Оскільки кількість делегатів обмежена, їхню діяльність простіше оптимізувати; як наслідок, цей алгоритм дозволяє обліковій системі досягти високої пропускної здатності.

Ідея створення та впровадження DPoS належить команді розробників децентралізованої платформи BitShares.

### Proof-of-importance

Щоби закріпити демократичний підхід до прийняття рішень, вигадали надбудову над алгоритмом PoS, яку назвали proof-of-importance (PoI) [81]. Її мета полягає у тому, що на вагу голосу учасника впливають декілька факторів: алгоритм зважає не тільки на кількість монет, якими володіє учасник, а й на ступінь його участі у роботі системи. У цьому разі має значення все: характер взаємодії користувача з іншими учасниками, звідки беруться монети, кому відправляються монети та поведінка в системі загалом. Таким чином, унеможливлюється ситуація, коли багаті стають тільки багатшими. Перша робоча реалізація PoI застосована в протоколі NEM.

### Механізми на основі BFT

Назва BFT (Byzantine Fault Tolerance) походить від жартівливого опису проблеми при побудові високонадійних систем [82]. Основою опису стала історія про візантійських генералів, які організовують атаку на деяке місто. Завдання генералів – дійти єдиного рішення. Відомо, що серед них є кілька зрадників. Зрадники поводять себе довільно (з наміром порушити функціонування системи). До того ж, необхідно враховувати, що зрадники можуть впливати на передачу повідомлень між чесними генералами, для яких важливо чи одночасно атакувати місто, чи одночасно відступити. Якщо частина чесних генералів відступить, то противник переможе армію по частинах. Тому всім генералам необхідно дійти узгодженого рішення. Описану вище постановку завдання було опубліковано в одній науковій роботі, звідки й пішла назва властивості алгоритмів досягнення консенсусу – BFT [111]. Сьогодні така проблема може опинитися актуальною не тільки для генералів, але й, наприклад, для футбольної команди (рис. 5.8).

![Рисунок 5.8 – Досягнення консенсусу за допомогою BFT](/resources/img/volume-1/5.2-difference-in-consensus-approaches/5.8-bft.png)

> **Умови роботи механізму досягнення консенсусу на основі BFT**
>> * *Вузли, що взаємодіють, рівноправні* 
>> * *Серед учасників можуть бути зловмисники, які діють скоординовано* 
>> * *Невідомо, хто з валідаторів є зловмисник* 
>> * *Чесні учасники становлять більш ніж ⅔ від загальної кількості* 
>> * *У мережі можуть траплятися збої та затримки* 

Також відзначимо, що кількість учасників у системі відома заздалегідь і вони знають один одного. Є два варіанти вирішення завдання: атакувати чи відступити. Приймається, що кількість чесних вузлів становить щонайменше ⅔ + 1 учасників.

Під час реалізації властивості BFT обмежується кількість кроків, за які всі чесні валідатори повинні дійти спільного рішення. Важливо також те, що учасники BFT-протоколу гарантовано доходять спільного рішення, який надалі не може бути змінено чи скасовано. Для не BFT-протоколів (у строгому визначенні) імовірність скасування рішення експоненціально спадає, але не дорівнює нулю.

### FBA

Federated Byzantine Agreement (FBA) уперше було представлено в Ripple і пізніше допрацьовано в Stellar [83]. Цей протокол досягнення консенсусу дозволяє досягати згоди серед великої (потенційно невідомої) кількості учасників (близько декількох тисяч), кожний із яких у загальному разі не знайомий з усіма іншими особисто.

Кожний учасник довіряє тільки обмеженому колу інших учасників (3–10) і, отже, досягає консенсусу у своєму вузькому колі. Проте через те, що соціальні зв’язки перетинаються, згоду можна досягти в усій системі (рис. 5.9).

![Рисунок 5.9 – Досягнення консенсусу за допомогою FBA](/resources/img/volume-1/5.2-difference-in-consensus-approaches/5.9-fba.png)

Реалізацій або аналогів такого механізму у світі дуже мало. У такий спосіб розповсюджуються революційні ідеї, коли люди діляться новинами та «заражають» ідеєю інших. Прийняття остаточного рішення в системі, що застосовує цей механізм, потребує більше часу порівняно з системами, де кожний валідатор знайомий із кожним іншим.

### Протоколи досягнення консенсусу, що базуються на DAG

*Directed acyclic graph* (DAG) – не спосіб досягнення консенсусу, але за допомогою цього способу організування даних можна покращити наявні механізми. Передусім, його використовують у системах, які вимагають асинхронної участі великої кількості валідаторів.

Уперше застосування цієї ідеї було запропоновано у двох протоколах: SPECTRE [84] та PHANTOM [85].

Суть підходу полягає у тому, що валідатор включає до заголовка свого блока посилання на такі блоки, які вважає правильними, але на які ще не посилалися інші валідатори (згідно з поточним станом мережі, який він бачить). Після цього валідатор відправляє свій блок до мережі. Виходить структура, у яку включено всі блоки, видимі для валідаторів у поточний момент часу. Таким чином, усі блоки, які могли би стати orphan blocks, буде включено до графу (рис. 5.10). Це означає, що голоси чесних валідаторів не буде витрачено даремно. Потенційно це один із найефективніших способів організування взаємодії великої кількості валідаторів, які працюють одночасно, що позитивно впливає на надійність обліку та рівень захищеності від атак подвійного витрачання та схожих.

![Рисунок 5.10 – Структура DAG](/resources/img/volume-1/5.2-difference-in-consensus-approaches/5.10-dag.png)

Слабке місце наявних реалізацій систем, що використовують DAG, полягає в централізації процесу вирішення конфліктів (транзакцій із подвійною витратою). Цей процес виконують *witness nodes* у ByteBall і *coordinator* в IOTA. У будь-якому разі використання DAG – відносно новий підхід із високим потенціалом застосування в permissioned системах.

### Основні критерії класифікації механізмів досягнення консенсусу

Розглянувши особливості кожного з механізмів досягнення консенсусу, виокремимо критерії для їх класифікування:
* Необхідність довіри до валідаторів
* Анонімність валідаторів
* Вимоги щодо наявності репутації у валідаторів
* Право стати валідатором
* Пропускна здатність
* Час повного підтвердження транзакції

Зверніть увагу на таблицю нижче (табл. 5.2). Існують такі механізми, у яких довіра до валідаторів не потрібна. Цьому сприяє низка обставин, як-от правила системи, що мотивують валідаторів поводити себе чесно, а також взаємозамінюваність цих валідаторів, коли не має значення, хто саме братиме участь у підтвердженні.

![Таблиця 5.2 – Порівняння різних механізмів досягнення консенсусу](/resources/img/volume-1/5.2-difference-in-consensus-approaches/table-5.2-comparison.png)

Ще один важливий фактор – право стати валідатором. Цей процес може відбуватися як на загальнодоступній підставі, так і вимагати ухвалення групи вже наявних валідаторів.

На практиці алгоритми досягнення консенсусу можуть забезпечити різну пропускну здатність. Теоретично, якщо необхідно, її можливо підвищити для будь-якого з механізмів, наприклад, нарощуючи обчислювальні ресурси вузлів-валідаторів і збільшуючи розмір блока. Проте це може значно зменшити ступінь децентралізації облікової системи. У низці випадків така модифікація – скоріше недолік, аніж перевага.

Слід розуміти, що для PoW та PoS у принципі дуже складно зменшити час підтвердження транзакцій. Водночас DPoS і PBFT влаштовані так, що достатня кількість валідаторів устигає досягти одностайності за короткий строк.

### Підсумки

Механізм досягнення консенсусу – це основа надійної роботи децентралізованої облікової системи. Залежно від потреб і завдань конкретного бізнесу під час вибирання облікової системи розглядають конкретний механізм, оскільки від нього залежатимуть її властивості.

Різноманітні механізми досягнення консенсусу націлені на знаходження оптимального компромісу між необхідним рівнем довіри, часом, необхідним для прийняття рішень, ступенем нескасовуваності прийнятих рішень та пропускною здатністю системи. Рішення щодо вибору конкретного алгоритму досягнення консенсусу має ґрунтуватися на результатах ретельного аналізу вимог до безпеки системи.

**Поширені міфи**

*Вихідний код Bitcoin можливо оптимізувати під будь-яку облікову систему.*

Мабуть, поширена хибна думка, що можна взяти вихідний код Bitcoin чи Ethereum і вільно застосувати його в будь-якому новому проєкті. На практиці трапляються приклади, коли розробник збирається спроєктувати цифрову валюту та робить форк Bitcoin, де відразу передбачено майнінг. За цього незрозуміло, хто виконуватиме роль валідатора, і далеко не завжди майнінг взагалі потрібний у реалізації цієї системи. 

*Немає жодного сенсу в централізованій обліковій системі з застосуванням технології blockchain.*

Звернімо увагу на наступний приклад. Люди називають Ripple (XRP) централізованою цифровою валютою. Вони мають рацію щодо емісії монет і валідації транзакцій, але не щодо аудиту та зберігання копій бази даних. Будь-хто може запустити вузол мережі Ripple та верифікувати транзакції, але не може формувати блоки й емітувати нові монети XRP.

Також помилково розцінювати децентралізовану облікову систему з обмеженим доступом як централізовану. Мало сенсу в досягненні консенсусу тільки тоді, коли всіх валідаторів контролює одна організація. Проте навіть у випадку банку з багатьма відділеннями пригожий BFT- консенсус може запобігти шахрайству чи атаці, спрямованій на єдину точку відмови (типова проблема для багатьох банків). Правильне використання особливостей технології blockchain може допомогти системі надати користувачам основні послуги безпеки: цілісність, неспростовність і доступність.

*У разі використання протоколу PoW валідатори даремно витрачають електроенергію.*

Один тільки пригожий спосіб задовольнити вимогам у системі Bitcoin (їх ми розглядали в 2.3 та 4.2) – це, фактично, PoW, який робить невигідним спам і підтвердження некоректних транзакцій, оскільки підприємці-майнери платят високу ціну за можливість брати участь у цьому процесі та сильно ризикують не отримати винагороду, якщо намагаються підтвердити транзакції, які не відповідають правилам протоколу. Це не марне енергоспоживання, а, скоріше, ціна, яку необхідно заплатити за використання незалежної та стійкої до цензури платіжної системи, якою і є Bitcoin.

**Часті запитання**

*– Чи можливий гібрид proof-of-work і proof-of-stake?*

Так, авжеж. Існують облікові системи, які так працюють, наприклад, Peercoin і Decred.

*– Чи можливо організувати дворівневий консенсус задля покращення характеристик облікової системи?*

Так, фактично, це випадок DPoS. Такий підхід уже використовують у деяких системах, наприклад, в BitShares, але там – інша модель безпеки. Ідея полягає в тому, що учасники за принципом PoS вибирають інших учасників на пост валідаторів, які, зі свого боку, формують блоки. Частота генерації блоків у BitShares у сотні разів вища.

*– За використання PoS виходить, що користувач із найбільшим балансом збере переважну більшість монет і консенсус буде порушено?*

По-перше, користувач не один збирає монети. Їх збирають усі користувачі пропорційно до свого балансу. По-друге, у кожного також є потреба витрачати монети. По-третє, валідаторам невигідно порушувати процес досягнення консенсусу, оскільки вони зберігають заощадження у цій системі.

Варто окремо розглянути випадок, коли користувача не має жодних монет, але він бере участь у видобуванні блоків. Чи є в нього шанси? Зазвичай, якщо система використовує механізм досягнення консенсусу PoS, початкова емісія централізована. У цьому разі користувач муситиме придбати монети. Інший підхід під час побудування систем передбачає гібридну схему (PoW та PoS), використовуючи яку кожен користувач може на початковому етапі видобувати монети за допомогою майнінгу, а потім перейти на алгоритм досягнення консенсусу PoS.

## 5.3 Обмеження технології blockchain і складнощі її застосування

Блокчейн та смарт-контракти сприймаються як перспективні та багатообіцяючі технології для впровадження у наявну регульовану інфраструктуру, але нині ситуація навколо них дещо складніша, ніж може здатися на перший погляд.

Почнемо з того, що ми говоримо про регульоване середовище, в якому відповідальність за ризики несуть конкретні сторони. Перехід до епохи цифрової взаємодії вимагає застосувати максимально надійні технології, що забезпечать учасникам системи впевненість у тому, що дані, які вони бачать, справжні. Інформацію, яку будуть зберігати в електронних реєстрах, має бути захищено від несанкціонованих змін.

Технологія блокчейн дозволяє створювати такі системи. Навіть більше, у цьому випадку не потрібна довіра учасників один до одного чи до третьої сторони. Проте потрібно вирішити деякі складні задачі, аби зробити можливим упровадження таких систем у повсякденне життя.

> **Задачі, що супроводжують упровадження облікових систем із застосуванням блокчейна**
>> * *Упровадити цифрову ідентифікацію (digital identity)* 
>> * *Цифровізувати (digitalize) усі процеси* 
>> * *Прийняти єдині правила оброблення даних* 
>> * *Здійснювати облік усіх активів ув одній системі* 
>> * *Організувати децентралізоване прийняття рішень*

### Упровадження digital identity

*Digital identity* дозволяє зв’язувати певні дії користувача з його особою.

У межах однієї організації (*централізованого середовища*) реалізувати це доволі просто. Однак коли мова заходить про консорціум компаній або державу, реалізація стає дуже складною, бо зв'язок між особою користувача та діями, які він учиняє в цифровому світі, має бути підтверджений юридично. Підтвердження має бути таким, щоби не виникало розбіжностей під час доведення факту взаємодії певних користувачів.

У цьому напрямі інтенсивно розвивається Естонія. Уряд цієї держави вже декілька років активно впроваджує електронні паспорти та дозволяє своїм громадянам голосувати за допомогою них.

Як бачимо, identity – ключовий елемент для взаємодії у цифровому світі.

### Цифровізація (digitalization) всіх процесів

Це не менш важлива умова. Будь-які інновації зазвичай передбачають поступовий перехід і деяку етапність. Однак у разі використання blockchain очевидно, що поки всі внутрішні процеси обліку компанії не буде цифровізовано, нічого не працюватиме. Уявімо, що організації стало потрібним перевірити клієнта в деякій зовнішній базі даних. Зараз це нерідко здійснюється за допомоги телефонного дзвінку. Однак натомість буде оптимально реалізувати автоматичну перевірку за протоколами за час, який відповідає очікуваному часу прийняття рішень (рис. 5.11).

![Рисунок 5.11 – Цифровізація процесів](/resources/img/volume-1/5.3-limitations-of-blockchain-technology-and-its-application-challenges/5.11-digitalization-of-process.png)

### Прийняття єдиних правил обробки даних

Спочатку потрібно виробити єдині правила для вирішення проблем підтвердження транзакцій, оновлення системи, відповідальності у разі непередбачених наслідків. Ці правила мають бути затверджені завчасно.

Потрібно створити єдину правову базу. Важливо, щоб оновлений підхід ураховував можливість існування децентралізованих систем із усіма їхніми особливостями, включно з розподіленою відповідальністю та особливостями прийняття рішень. Криптовалюти – показовий приклад того, наскільки складно вирішити цю задачу. Багато регуляторів уже почали рух у напрямі оновлення законодавства, щоб воно враховувало обіг криптовалют у світовій економіці. Однак поки що у суспільства більше запитань, ніж відповідей.

### Перенесення всіх цифрових активів до однієї облікової системи

У деякому сенсі використання технології blockchain припускає, що права власності на всі активи обробляються в одній обліковій системі. Власне, через це її використання настільки ефективне.

Річ у тім, що облікова система, спроектована з застосуванням blockchain, де достатньо добре визначено правила роботи, може гарантувати коректність і безпечність функціонування. Проте це можливо тільки тоді, коли сама облікова система самодостатня.

Тут поняття самодостатності можливо проілюструвати на прикладі Bitcoin. Система не використовує жодні зовнішні ресурси для перевірки транзакцій: вся інформація про адреси та UTXOs зберігається у внутрішніх базах даних від моменту виникнення Bitcoin. У межах такої системи отримані дані можуть вважатися вірогідними. Математиці та криптографії також не потрібно довіряти, бо вони працюють завжди однаково. Отже, користувач може бути впевненим, що він працює з прозорою та коректною системою.

В якості прикладу можна навести платформу для смарт-контрактів Ethereum, яка дозволяє торгувати всіма активами, випущеними на її основі. Якщо, скажімо, ми візьмемо будь-яку окрему систему обліку (як варіант, систему обліку прав власності на земельні ділянки), яку визнає уряд, тоді постає проблема синхронізації даних між двома системами. Нині єдиний спосіб досягти цього – використання довірених третіх сторін – оракулів (детальніше в 6.3).

### Організація децентралізованого прийняття рішень

П'ятим аспектом виокремлено децентралізоване прийняття рішень, а саме погодженість усіх сторін процесу щодо того, як прийматимуться рішення. Цієї погодженості на практиці дуже непросто досягти, тому що людям складно домовитися, коли справа стосується особистої вигоди від прийнятого рішення. Це може бути зумовлено будь-чим: політичними амбіціями, меркантильними інтересами тощо. У межах одного підприємства ще можливо прийняти узгоджене рішення, але тільки-но з'являється конкуренція та виникають різні погляди, це стає нагадувати політичну боротьбу. Саме з цієї причини існує так мало робочих варіантів застосування блокчейна у підприємництві.

> **Фактори, що обмежують застосування технології blockchain**
>> * *Висока надлишковість*
>> * *Затримки синхронізації вузлів* 
>> * *Проблема управління змінами (governance)* 
>> * *Проблема відповідальності*

Ці обмеження фундаментальні, оскільки випливають із самого децентралізованого підходу. Розберімо їх детальніше

### Обмеження пропускної здатності

*Пропускну здатність (capacity)* облікової системи зазвичай визначається як кількість підтверджених транзакцій або сумарний обсяг даних таких транзакцій за одиницю часу. Відповідно, пропускна здатність вимірюється в одиницях tps (транзакції на секунду) або B/s (байти на секунду). Проблеми обмеження продуктивності та масштабованості децентралізованої облікової системи тісно пов’язані між собою, але насправді це абстрактні величини, які неможливо виміряти, тому немає сенсу їх використовувати. Натомість є більш точні показники: пропускна здатність, час підтвердження транзакції та максимальна кількість валідаторів, які можуть брати участь у досягненні консенсусу одночасно.

Для наочності та простоти розуміння різниці у пропускній здатності скористаємося такою ілюстрацією (рис. 5.12). Дві різні служби доставки за один період часу можуть виконувати роботу з переміщення різної кількості вантажу. На їхні пропускні здатності впливатиме тип вибраного транспорту.

![Рисунок 5.12 – Приклад систем із різною пропускною здатністю](/resources/img/volume-1/5.3-limitations-of-blockchain-technology-and-its-application-challenges/5.12-low-and-high-capacities.png)

Децентралізована система переважно має меншу пропускну здатність, ніж система з одним центром управління, тому що внесення змін потребує більше часу. Необхідно розповсюджувати між усіма учасниками, і вони мають досягти консенсусу щодо наявної інформації: рішення приймають уже не в одному місці, а в декількох. Ці затримки збільшують час відгуку облікової системи.

### Час підтвердження транзакції

Зрозуміти обмеження *часу підтвердження (confirmation time)* допоможе приклад на рис. 5.13. Завдання того самого обсягу даних можливо вирішити як швидко, так і повільно залежно від того, який підхід до вирішення було обрано. У контексті завдання з доставки вантажу на час її виконання впливатиме тип вибраного транспорту.

![Рисунок 5.13 – Приклад систем із різним часом виконання завдання](/resources/img/volume-1/5.3-limitations-of-blockchain-technology-and-its-application-challenges/5.13-transaction-cong-time.png)

Проблема зберігання даних у повному обсязі також спричиняє додаткові обмеження. Адже кожен, хто бере участь у прийнятті рішень, має зберігати свою копію бази даних системи, що постійно оновлюється, синхронізуючись із іншими вузлами мережі (рис. 5.14).

![Рисунок 5.14 – Проблема зберігання даних у повному обсязі](/resources/img/volume-1/5.3-limitations-of-blockchain-technology-and-its-application-challenges/5.14-redundancy.png)

Залежно від поточних умов у мережі (потоку нових транзакцій, hash rate, параметра складності тощо) протягом лютого–серпня 2018 року середній час першого підтвердження блоку Біткоіна коливалося від 6 до 18 хвилин, але було зафіксовано затримки майже до півгодини.

### Управління змінами (governance)

Розроблення ПЗ системи в межах однієї компанії – це процес, який управляється централізовано та який характеризується наявністю відповідальних сторін і чітким планом. Будь-які пропозиції щодо внесення змін затверджує вузьке коло осіб, причетних до розробки правил роботи системи.

Для правильно застосованої децентралізованої облікової системи демократизація управління змінами благотворна. Що чисельніша відкрита спільнота, яка сперечається та пропонує рішення, то більше можливостей для цінних покращень. Якщо більшість підтримає покращення, його буде додано до наступного оновлення. Таким чином, кожний може запропонувати своє оновлення та відкрито обговорити його переваги та недоліки (рис. 5.15).

![Рисунок 5.15 – Оновлення протоколу в децентралізованій систем](/resources/img/volume-1/5.3-limitations-of-blockchain-technology-and-its-application-challenges/5.15-protocol-update.png)

Однак колективне управління завжди складніше за одноосібне, тому що людям складно досягати одностайності швидко. Рішення в такій системі приймають завжди повільніше, позаяк учасникам потрібний час, щоби домовитися.

### Розподілена відповідальність

На шляху до практичного впровадження децентралізованих технологій осібно стоїть неготовність суспільства до прийняття наслідків децентралізованого підходу. Неготовність полягає у тому, що ми звикли бачити конкретну людину, відповідальну за щось конкретне. Так відбувається у системі централізованого управління, що стала для нас традіційною.

Коли вас обслуговують у певній організації, то у разі виникнення непорозумінь ви зв’язуєтеся з її представниками та з’ясовуєте, у чому річ. Наприклад, коли ви придбали автівку, а за тиждень вона перестала заводитися, ви звертаєтеся до компанії, де ви її купили, і вимагаєте відшкодування коштів. Інакше (якщо не вдається домогтися відшкодування) ви звертаєтеся до суду, що задовольнить ваші вимоги в законному порядку, примусивши компанію повернути гроші та відшкодувати ваші збитки. У будь-якому разі ви знаходите «крайнього», тобто того, хто відповідальний за прийняте рішення.

Якщо в разі центру управління відповідальність чітко визначено, то в разі розподіленої системи відповідальність отримує дещо розмите значення. Тут слушніше замінити слово відповідальність на ризик, тому що саме ризики несуть учасники. Гарантія коректної роботи системи – правила, за якими вона функціонує, і вони відомі всім учасникам. Кожний може перевірити дії решти на відповідність правилам роботи протоколу.

Ці ризики проявляються або в поведінці користувачів, або у вразливостях, через які можливо вплинути на правила: атаки на той-таки протокол. В останньому аспекті децентралізована система куди стійкіша за централізовану. У по-справжньому децентралізованій системі жодний учасник, зокрема розробник, не здатний зробити зміни одноосібно. Тому ніякий суд не може реалізувати рішення, суперечне до правил роботи протоколу. Щоби змінити стан системи, потрібна згода більшості учасників, досягнута без порушень установлених завчасно правил.

Тут потрібна інша модель законодавчого підходу: потрібні нові юридичні моделі та, можливо, законодавча база, яка передбачатиме існування таких систем. Таким чином, до певного моменту обов'язки з забезпечення безпеки та дотримання деяких вимог покладено на творців цієї системи, а після нього відповідальність переходить до користувача, який погодився з правилами та прийняв можливі ризики.

### Оновлення протоколу

Ще одна істотна особливість децентралізованих систем полягає у підході до оновлень. Коли з'являється пропозиція щодо покращення правил роботи системи, на нього може чекати як одностайне прийняття, так і розбіжності серед учасників. Інакше кажучи, ми спостерігаємо проблему *governance* в дії.

Якщо ці розбіжності доволі серйозні, то справа може дійти до форку, тобто розділення ланцюжка блоків і появи нової системи на базі старої, але вже з іншими правилами.

Так було з Bitcoin у 2017 році, коли з'явився його форк – Bcash. Було запропоновано збільшити розмір блока в мережі Bitcoin з 1 MB до 8 MB, щоби підвищити пропускну здатність. Учасники, які підтримали пропозицію, оновили своє програмне забезпечення та стали працювати за новими правилами. Таким чином, вийшло дві системи: Bitcoin, учасники якого надалі працювали за старими правилами (з блоком розміру 1 MB), і Bcash, блоки якої вже мали розмір 8 MB (детальніше в 6.1).

Як інший приклад можна навести ситуацію з Ethereum. У 2016 році зловмисники викрали близько 60 млн доларів США, інвестованих у проект DAO, розроблений на платформі Ethereum [86]. Команда розробників вирішила втрутитися й провела оновлення протоколу, у якому зробила відкочення (rollback) системи та відкликала смарт-контракти, які було пущено в дію у викраденні через наявність уразливості. У підсумку, усі кошти повернулися на баланс проекту. Проте не всі оцінили такий хід позитивно. Противники цього оновлення та викликаного ним форку надалі працювали в старій системі, яку назвали Ethereum Classic, а ті, хто підтримав відкочення, стали працювати в новій – Ethereum.

### Підсумки

Правильно впроваджена технологія блокчейн може забезпечити прозору бізнес-модель і доступність автоматизованого аудиту. За залучення до партнерських відносин компанія отримує додаткові перспективи розвитку бізнесу, позаяк довіра користувачів до такої системи збільшуватися. Проте на шляху до втілення цієї ідеї стоїть низка складнощів, які потрібно врахувати та подолати: складність проектування, налаштування та підтримання децентралізованої облікової системи здебільшого набагато вища, ніж централізованих альтернатив.

Щоби говорити про застосування blockchain у реальній економіці, потрібно створити умови для практичної реалізації. Для цього потрібно цифровізувати більшість процесів взаємодіяння в суспільстві, визначити стандарти ідентифікування особи в цифровому просторі, підготувати законодавчу базу для вирішення проблем із відповідальністю.

[РОЗВИТОК ДЕЦЕНТРАЛІЗОВАНИХ ТЕХНОЛОГІЙ](https://github.com/distributed-lab/blockchain-and-decentralized-systems-book/blob/main/chapters/volume-1/ua/6-development-of-decentralized-technologies.md)