# 7. RSA
–ê–ª–≥–æ—Ä–∏—Ç–º —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è RSA —î –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è. –°—å–æ–≥–æ–¥–Ω—ñ –¥—É–∂–µ —á–∞—Å—Ç–æ —Ü–µ–π –∞–ª–≥–æ—Ä–∏—Ç–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è 
–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó –∑–∞—Ö–∏—â–µ–Ω–æ–≥–æ –∫–∞–Ω–∞–ª—É –º—ñ–∂ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ (—Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ —Å–µ–∫—Ä–µ—Ç—É —Ç–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –π–æ–≥–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é RSA).

–ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –∫—Ä–æ–∫—ñ–≤ –∞–ª–≥–æ—Ä–∏—Ç–º—É RSA (–≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤):
1. –û–±–∏—Ä–∞—é—Ç—å—Å—è –¥–≤–∞ –≤–µ–ª–∏–∫—ñ –ø—Ä–æ—Å—Ç—ñ —á–∏—Å–ª–∞ p –∏ q; 
2. –û–±—á–∏—Å–ª—é—î—Ç—å—Å—è: n = p ‚ãÖ q, m = (p ‚Äì 1) ‚ãÖ (q ‚Äì 1); 
3. –û–±–∏—Ä–∞—î—Ç—å—Å—è –≤–∏–ø–∞–¥–∫–æ–≤–µ —á–∏—Å–ª–æ d, –≤–∑–∞—î–º–Ω–æ –ø—Ä–æ—Å—Ç–µ —Å m; 
4. –í–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è —Ç–∞–∫–µ —á–∏—Å–ª–æ e, –¥–ª—è —è–∫–æ–≥–æ —î —ñ—Å—Ç–∏–Ω–Ω–∏–º –≤–∏—Ä–∞–∑: (e ‚ãÖ d) mod (m) = 1; 
5. –ß–∏—Å–ª–∞ e —Ç–∞ n ‚Äì —Ü–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –∫–ª—é—á, –∞ —á–∏—Å–ª–∞ d –∏ n ‚Äì —Ü–µ –æ—Å–æ–±–∏—Å—Ç–∏–π –∫–ª—é—á.

–í—ñ–¥–∫—Ä–∏—Ç–∏–º –∫–ª—é—á–µ–º —à–∏—Ñ—Ä—É—é—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –∞ –æ—Å–æ–±–∏—Å—Ç–∏–º ‚Äì —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤—É—é—Ç—å. –ü–∞—Ä–∞ —á–∏—Å–µ–ª –æ—Å–æ–±–∏—Å—Ç–æ–≥–æ –∫–ª—é—á–∞ —Ç—Ä–∏–º–∞—î—Ç—å—Å—è —É —Ç–∞—î–º–Ω–∏—Ü—ñ.

–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ –¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∞–ª–≥–æ—Ä–∏—Ç–º—É RSA:
1. –í–∏—Ö—ñ–¥–Ω–∏–π —Ç–µ–∫—Å—Ç —Ä–æ–∑–±–∏–≤–∞—î—Ç—å—Å—è –Ω–∞ –±–ª–æ–∫–∏, –∫–æ–∂–µ–Ω –∑ —è–∫–∏—Ö –º–æ–∂–µ –±—É—Ç–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —É –≤–∏–≥–ª—è–¥—ñ —á–∏—Å–ª–∞ M(i); 
2. –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —Ç–∞–∫: C(i) = (M(i)e) mod n; 
3. –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —Ç–∞–∫: M(i) = (C(i)d) mod n.

```
Pseudo-code:

KeyGen(){
    P and Q <= primary big numbers.
    n = P*Q.
 	e <= integer value, not be a factor of n, 1<e<Œ¶(n), Œ¶(n) = (P-1)(Q-1)
    d = (k*Œ¶(n) + 1) / e , for some integer k

	PrivateKey (d, n)
	PublicKey (e, n)
}

Encrypt(message, PublicKey){
	return powmod(message, e, n)
}

Decrypt(ciphertext, PrivateKey){
	return powmod(ciphertext, d, n)
}
```
‚úØ –°–ø—Ä–æ–±—É–π—Ç–µ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º RSA, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –º–∞—Ç–µ—Ä—ñ–∞–ª —Ü—å–æ–≥–æ —Ä–æ–∑–¥—ñ–ª—É

–°–∞–º —Ç–µ–∫—Å—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É —Ç–∞ —Ç–µ—Å—Ç–æ–≤—ñ –≤–µ–∫—Ç–æ—Ä–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –∑–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º:
https://datatracker.ietf.org/doc/html/rfc3447

–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–ª–∞—Å–Ω–æ—ó —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –∞–ª–≥–æ—Ä–∏—Ç–º—É RSA –º–æ–∂–µ –±—É—Ç–∏ —Å–∫–ª–∞–¥–Ω–∏–º –∑–∞–≤–¥–∞–Ω–Ω—è–º, –æ—Å–æ–±–ª–∏–≤–æ –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤–±—É–¥–æ–≤–∞–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫. 
–û–¥–∏–Ω –∑ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º, –æ–¥–Ω–∞–∫ —Ü–µ–π –∫–æ–¥ —Å—Ç–≤–æ—Ä—é—î –∫–ª—é—á—ñ RSA, —à–∏—Ñ—Ä—É—î —Ç–∞ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤—É—î 
–≤—ñ–¥–∫—Ä–∏—Ç–∏–π —Ç–µ–∫—Å—Ç. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü–µ–π –ø—Ä–∏–∫–ª–∞–¥ —Å–ø—Ä–æ—â–µ–Ω–∏–π —Ç–∞ –Ω–µ –ø—Ä–∏–¥–∞—Ç–Ω–∏–π –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ —Ä–µ–∞–ª—å–Ω–∏—Ö –∑–∞—Å—Ç–æ—Å—É–Ω–∫–∞—Ö. 
–î–ª—è —Ä–µ–∞–ª—å–Ω–∏—Ö –∑–∞—Å—Ç–æ—Å—É–Ω–∫—ñ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏, —è–∫—ñ –ø—Ä–æ–π—à–ª–∏ –∞—É–¥–∏—Ç –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó.

ü§ñ

```go
package main

import (
	"fmt"
	"math/big"
	"math/rand"
	"time"
)

func main() {
	// –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤
	p, q := generatePrimes(128)
	n := new(big.Int).Mul(p, q)
	e := big.NewInt(65537)
	phi := new(big.Int).Mul(new(big.Int).Sub(p, big.NewInt(1)), new(big.Int).Sub(q, big.NewInt(1)))
	d := new(big.Int).ModInverse(e, phi)

	fmt.Println("–ö–ª—é—á—ñ:")
	fmt.Println("  –ü—É–±–ª—ñ—á–Ω–∏–π:", n, e)
	fmt.Println("  –ü—Ä–∏–≤–∞—Ç–Ω–∏–π:", n, d)

	// –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
	plaintext := big.NewInt(123456)
	ciphertext := encrypt(plaintext, e, n)
	fmt.Println("–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è:")
	fmt.Println("  –í—ñ–¥–∫—Ä–∏—Ç–∏–π —Ç–µ–∫—Å—Ç:", plaintext)
	fmt.Println("  –®–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç:", ciphertext)

	// –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
	decrypted := decrypt(ciphertext, d, n)
	fmt.Println("–†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è:")
	fmt.Println("  –®–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç:", ciphertext)
	fmt.Println("  –í—ñ–¥–∫—Ä–∏—Ç–∏–π —Ç–µ–∫—Å—Ç:", decrypted)
}

func encrypt(m, e, n *big.Int) *big.Int {
	return new(big.Int).Exp(m, e, n)
}

func decrypt(c, d, n *big.Int) *big.Int {
	return new(big.Int).Exp(c, d, n)
}

func generatePrimes(bits int) (p, q *big.Int) {
	randSource := rand.New(rand.NewSource(time.Now().UnixNano()))
	for {
		p, _ = rand.Prime(randSource, bits)
		q, _ = rand.Prime(randSource, bits)
		if p.Cmp(q) != 0 {
			break
		}
	}
	return
}

func gcd(a, b *big.Int) *big.Int {
	for b.Sign() > 0 {
		a, b = b, new(big.Int).Mod(a, b)
	}
	return a
}
```

> –¶–µ–π –∫–æ–¥ –ø—Ä–∞—Ü—é—î –∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–∏–º–∏ –¥–æ–≤–∂–∏–Ω–∞–º–∏ –∫–ª—é—á—ñ–≤ —ñ –º–æ–¥—É–ª—è, –∞–ª–µ –±—É–±–ª–æ–± –≥–∞—Ä–Ω–æ —Ä–µ–∞–ª—ñ–∑–æ–≤—É—Ç–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫—É –∫–ª—é—á—ñ–≤ —ñ –º–æ–¥—É–ª—è 
–¥–æ–≤—ñ–ª—å–Ω–æ—ó –¥–æ–≤–∂–∏–Ω–∏. –©–µ —Ü–µ–π –∫–æ–¥ –∑–∞–¥–∞—î –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –∫–ª—é—á –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ—é, –∞ —Ç—Ä–µ–±–∞ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É –Ω–æ–≤–∏–π. –ù–∞—Å–ø—Ä–∞–≤–¥—ñ 
–≥–µ–Ω–µ—Ä–∞—Ü—ñ—é –∫–ª—é—á—ñ–≤ —ñ –º–æ–¥—É–ª—è –≤–∞—Ä—Ç–æ –±—É–ª–æ –± –≤–∏–Ω–µ—Å—Ç–∏ –≤ –æ–∫—Ä–µ–º—É —Ñ—É–Ω–∫—Ü—ñ—é. –¢–∞–∫–æ–∂ —É—Å—ñ –∑–Ω–∞—á–µ–Ω–Ω—è (–∫–ª—é—á—ñ, –º–æ–¥—É–ª—å, –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è) –º–∞—é—Ç—å 
–∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—å —ñ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏—Å—å –º—ñ–∂ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏ –º–∞—Å–∏–≤–∞–º–∏ –±–∞–π—Ç—ñ–≤. –¶–µ –≤–∞–∂–ª–∏–≤–æ –¥–ª—è —Ç–æ–≥–æ —â–æ–± —Ä—ñ–∑–Ω—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –º–æ–≥–ª–∏ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ 
–æ–¥–Ω–∞–∫–æ–≤–∏–º–∏ –∫–ª—é—á–∞–º–∏ —ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—è–º–∏ –∑ –º–æ–∂–ª–∏–≤–æ—Å—Ç—é –µ–∫—Å–ø–æ—Ä—Ç—É —Ç–∞ —ñ–º–ø–æ—Ä—Ç—É –∫–ª—é—á—ñ–≤. –¢—É—Ç —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –ª–∏—à–µ –∞–ª–≥–æ—Ä–∏—Ç–º —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è, 
–∞–ª–µ —Å—Ç—É–¥–µ–Ω—Ç–∏ –º–æ–∂—É—Ç—å —Ä–æ–∑—à–∏—Ä–∏—Ç–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –ø—ñ–¥–ø–∏—Å—É.

–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∑ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—î—é: